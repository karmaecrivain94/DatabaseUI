//THIS IS A CUSTOMIZED FOR ACTEUROPA VERSION OF METRICSGRAPHICS.JS.

!function(a,b){"function"==typeof define&&define.amd?define(["d3"],b):"object"==typeof exports?module.exports=b(require("d3")):a.MG=b(a.d3)}(this,function(a){function b(){return"undefined"!=typeof jQuery||"undefined"!=typeof $}function c(a){var b;switch(a.processed.x_time_frame){case"millis":b=MG.time_format(a.utc_time,"%b %e, %Y  %H:%M:%S.%L");break;case"seconds":b=MG.time_format(a.utc_time,"%b %e, %Y  %H:%M:%S");break;case"less-than-a-day":b=MG.time_format(a.utc_time,"%b %e, %Y  %I:%M%p");break;case"four-days":b=MG.time_format(a.utc_time,"%b %e, %Y  %I:%M%p");break;default:b=MG.time_format(a.utc_time,"%b %e, %Y")}return b}function d(a,b){return!(a[b.x_accessor]<b.processed.min_x||a[b.x_accessor]>b.processed.max_x||a[b.y_accessor]<b.processed.min_y||a[b.y_accessor]>b.processed.max_y)}function e(a){return"[object Array]"===Object.prototype.toString.call(a)}function f(a){return"[object Function]"===Object.prototype.toString.call(a)}function g(a){return e(a)&&0===a.length}function h(a){return"[object Object]"===Object.prototype.toString.call(a)}function i(b){var c=b.map(function(a){return e(a)===!0&&a.length>0});return a.sum(c)===b.length}function j(b){var c=b.map(function(a){return h(a)===!0});return a.sum(c)===b.length}function k(a){return g(a)||j(a)}function l(a,b){return a.map(function(a){return a[b]})}function m(a){return a.reduce(function(a,b){return a[b]=a[b]+1||1,a},{})}function n(a){return a.height-a.bottom}function o(a){return n(a)-a.buffer}function p(a){return a.top}function q(a){return p(a)+a.buffer}function r(a){return a.left}function s(a){return r(a)+a.buffer}function t(a){return a.width-a.right}function u(a){return t(a)-a.buffer}function v(a){a.exit().remove()}function w(a,b){a.selectAll(b).remove()}function x(a,b){return a.append("g").classed(b,!0)}function y(a,b){var c=H(a.target),d=I(a.data),e=c.selectAll("line."+b).data(d);return e.enter().append("line").attr("class",b).attr("opacity",.3),v(e),v(e),e}function z(a,b,c){b.color_accessor?(a.attr("stroke",b.scalefns.colorf),a.classed(c,!1)):(a.attr("stroke",null),a.classed(c,!0))}function A(b,c){c&&b.attr({dy:0,transform:function(){var b=a.select(this);return"rotate("+c+" "+b.attr("x")+","+b.attr("y")+")"}})}function B(a){if(a=a.node(),!a)return!1;for(var b=0;b<a.length;b++)if(F(a[b],a))return!0;return!1}function C(b,c){if(b&&1!=b.length)for(var d=0;d<b.length;d++)if(F(b[d],b)){var e=a.select(b[d]),f=+e.attr("y");f+8<c.top||(f=c.top-16),e.attr("y",f)}}function D(b){if(b&&1!=b.length){b.sort(function(b,c){return a.select(c).attr("y")-a.select(b).attr("y")}),b.reverse();for(var c,d,e,f=0;f<b.length;f++){d=a.select(b[f]).text();for(var g=0;g<b.length;g++)if(e=a.select(b[g]).text(),c=E(b[f],b[g]),c!==!1&&d!==e){var h=a.select(b[f]),i=+h.attr("y");i+=c,h.attr("y",i)}}}}function E(a,b){var c=a.getBoundingClientRect(),d=b.getBoundingClientRect();return!(c.top>d.bottom||c.top<d.top)&&d.bottom-c.top}function F(a,b){for(var c=a.getBoundingClientRect(),d=0;d<b.length;d++)if(b[d]!=a){var e=b[d].getBoundingClientRect();if(c.top===e.top&&e.left<=c.right&&e.right>=c.left)return!0}return!1}function G(a,b){var c=I(a.data);return c=c[0][a[b+"_accessor"]],"string"==typeof c?"categorical":"numerical"}function H(b){return a.select(b).select("svg")}function I(a){var b=[];return b.concat.apply(b,a)}function J(){return void 0===MG._next_elem_id&&(MG._next_elem_id=0),"mg-"+MG._next_elem_id++}function K(a){if("string"==typeof a)return L(a);if(a instanceof window.HTMLElement){var b=a.getAttribute("data-mg-uid");return b||(b=J(),a.setAttribute("data-mg-uid",b)),b}return console.warn("The specified target should be a string or an HTMLElement.",a),L(a)}function L(a){return a.replace(/[^a-zA-Z0-9 _-]+/g,"").replace(/ +?/g,"")}function M(b,c){return+a.select(b).style(c).replace(/px/g,"")}function N(a){return M(a,"width")}function O(a){return M(a,"height")}function P(a){return Nc(Array.prototype.slice.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a}function Q(a){return"[object Date]"===Object.prototype.toString.call(a)}function R(a){return"[object Object]"===Object.prototype.toString.call(a)}function S(a){return Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a)}function T(a){return"[object Function]"===Object.prototype.toString.call(a)}function U(a,b){var c,d=[],e=[];for(c=0;c<b.length;c++)d[b[c]]=!0;for(c=0;c<a.length;c++)d[a[c]]||e.push(a[c]);return e}function V(a,b){console.warn("Deprecation: "+a+(b?". This feature will be removed in "+b+".":" the near future.")),console.trace()}function W(a,b,c){var d,e=0;for(a.textContent=b,d=a.getBBox();d.width>c&&(a.textContent=b.slice(0,--e)+"...",d=a.getBBox(),"..."!==a.textContent););}function X(b,c,d,e){b.each(function(){for(var b,f=a.select(this),g=f.text().split(d||/\s+/).reverse(),h=[],i=0,j=1.1,k=(f.attr("y"),0),l=f.text(null).append("tspan").attr("x",0).attr("y",k+"em").attr(e||{});b=g.pop();)h.push(b),l.text(h.join(" ")),(null===c||l.node().getComputedTextLength()>c)&&(h.pop(),l.text(h.join(" ")),h=[b],l=f.append("tspan").attr("x",0).attr("y",++i*j+k+"em").attr(e||{}).text(b))})}function Y(a,b,c){MG.charts[a]={descriptor:b,defaults:c||{}}}function Z(c){"use strict";var d=H(c.target);if(d.select(".mg-header").remove(),c.target&&c.title){var e=d.insert("text").attr("class","mg-header").attr("x",c.center_title_full_width?c.width/2:(c.width+c.left-c.right)/2).attr("y",c.title_y_position).attr("text-anchor","middle").attr("dy","0.55em");if(e.append("tspan").attr("class","mg-chart-title").text(c.title),c.show_tooltips&&c.description&&b()){e.append("tspan").attr("class","mg-chart-description").attr("dx","0.3em").text("");var f=$(e.node());f.popover({html:!0,animation:!1,placement:"top",content:c.description,container:c.target,trigger:"manual",template:'<div class="popover mg-popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'}).on("mouseenter",function(){a.selectAll(c.target).selectAll(".mg-popover").remove(),$(this).popover("show"),$(a.select(c.target).select(".popover").node()).on("mouseleave",function(){f.popover("hide")})}).on("mouseleave",function(){setTimeout(function(){$(".popover:hover").length||f.popover("hide")},120)})}else c.show_tooltips&&c.description&&"undefined"==typeof $&&(c.error="In order to enable tooltips, please make sure you include jQuery.")}c.error&&Lc(c)}function _(a,b,c,d,e){a.scalefns[b]=function(b){return void 0===e?a.scales[c](b[d]):a.scales[c](b[d])+e}}function aa(a,b){return"bottom"===a||"top"===a?[s(b),u(b)]:"left"===a||"right"===a?[o(b),b.top]:void 0}function ba(b){var c={};return c.use_inflator=!1,c.zero_bottom=!1,c.scaleType="numerical",this.namespace=function(a){return c.namespace=a,c.namespace_accessor_name=c.namespace+"_accessor",c.scale_name=c.namespace.toUpperCase(),c.scalefn_name=c.namespace+"f",this},this.scaleName=function(a){return c.scale_name=a.toUpperCase(),c.scalefn_name=a+"f",this},this.inflateDomain=function(a){return c.use_inflator=a,this},this.zeroBottom=function(a){return c.zero_bottom=a,this},this.numericalDomainFromData=function(){var d=[];arguments.length>0&&(d=arguments);for(var e,f=0;f<b.data.length;f++)b.data[f].length>0&&(e=b.data[f]);c.is_time_series=!!Q(e[0][b[c.namespace_accessor_name]]),_(b,c.scalefn_name,c.scale_name,b[c.namespace_accessor_name]),ca(b,c,d,c.use_inflator);var g=b.utc_time?a.scaleUtc():a.scaleTime();return b.scales[c.scale_name]=c.is_time_series?g:T(b[c.namespace+"_scale_type"])?b.y_scale_type():"log"===b[c.namespace+"_scale_type"]?a.scaleLog():a.scaleLinear(),b.scales[c.scale_name].domain([b.processed["min_"+c.namespace],b.processed["max_"+c.namespace]]),c.scaleType="numerical",this},this.categoricalDomain=function(d){return b.scales[c.scale_name]=a.scaleOrdinal().domain(d),_(b,c.scalefn_name,c.scale_name,b[c.namespace_accessor_name]),this},this.categoricalDomainFromData=function(){var d=I(b.data);return c.categoricalVariables=a.set(d.map(function(a){return a[b[c.namespace_accessor_name]]})).values(),b.scales[c.scale_name]=a.scaleBand().domain(c.categoricalVariables),c.scaleType="categorical",this},this.numericalRange=function(a){return b.scales[c.scale_name].range("string"==typeof a?aa(a,b):a),this},this.categoricalRangeBands=function(a,d){void 0===d&&(d=!1);var e=c.namespace,f=b[e+"_padding_percentage"],g=b[e+"_outer_padding_percentage"];return"string"==typeof a?b.scales[c.scale_name].range(aa(a,b)).paddingInner(f).paddingOuter(g):b.scales[c.scale_name].range(a).paddingInner(f).paddingOuter(g),_(b,c.scalefn_name,c.scale_name,b[c.namespace_accessor_name],d?b.scales[c.scale_name].bandwidth()/2:0),this},this.categoricalRange=function(a){return b.scales[c.scale_name].range(a),_(b,c.scalefn_name,c.scale_name,b[c.namespace_accessor_name]),this},this.categoricalColorRange=function(){return b.scales[c.scale_name]=a.scaleOrdinal(b.scales[c.scale_name].domain().length>10?a.schemeCategory20:a.schemeCategory10),b.scales[c.scale_name].domain(c.categoricalVariables),_(b,c.scalefn_name,c.scale_name,b[c.namespace_accessor_name]),this},this.clamp=function(a){return b.scales[c.scale_name].clamp(a),this},this}function ca(b,c,d){var e=c.namespace,f=c.namespace_accessor_name,g=c.use_inflator,h=c.zero_bottom,i=b[f],j=I(b.data).map(function(a){return a[i]}).concat(I(d));"log"===b[e+"_scale_type"]&&(j=j.filter(function(a){return a>0}));var k=a.extent(j),l=k[0],m=k[1];h&&!b["min_"+e+"_from_data"]&&l>0&&!c.is_time_series&&(l="log"===b[e+"_scale_type"]?1:0),"log"!==b[e+"_scale_type"]&&0>l&&!c.is_time_series&&(l-=(l-l*b.inflator)*g),c.is_time_series||(m=0>m?m+(m-m*b.inflator)*g:m*(g?b.inflator:1)),l=b["min_"+e]||l,m=b["max_"+e]||m,l!==m||b["min_"+e]&&b["max_"+e]||(Q(l)?(m=new Date(MG.clone(l).setDate(l.getDate()+1)),l=new Date(MG.clone(l).setDate(l.getDate()-1))):"number"==typeof l&&(l-=1,m=l+1,ob(b))),b.processed["min_"+e]=l,b.processed["max_"+e]=m,MG.call_hook("x_axis.process_min_max",b,b.processed.min_x,b.processed.max_x),MG.call_hook("y_axis.process_min_max",b,b.processed.min_y,b.processed.max_y)}function da(b,c){return a.set(b.map(function(a){return a[c]})).values()}function ea(b){var c;return null===b.color_domain?"number"===b.color_type?c=a.extent(b.data[0],function(a){return a[b.color_accessor]}):"category"===b.color_type&&(c=da(b.data[0],b.color_accessor)):c=b.color_domain,c}function fa(a){var b;return b=null===a.color_range?"number"===a.color_type?["blue","red"]:null:a.color_range}function ga(a,b){function c(a){return 1e3===a?3:1e6===a?7:Math.log(a)/Math.LN10}var d=a[b+"_accessor"],e=a.scales[b.toUpperCase()].ticks(a[b+"ax_count"]),f=a.processed["max_"+b];"log"===a[b+"_scale_type"]&&(e=e.filter(function(a){return Math.abs(c(a))%1<1e-6||Math.abs(c(a))%1>1-1e-6}));var g=e.length,h=!0;a.data.forEach(function(a){a.forEach(function(a){return a[d]%1!==0?(h=!1,!1):void 0})}),h&&g>f&&"count"===a.format&&(e=e.filter(function(a){return a%1===0})),a.processed[b+"_ticks"]=e}function ha(a,b){var c=b.position,d=b.namespace,e={};return"left"===c&&(e.x1=r(a)+1,e.x2=r(a)+a.rug_buffer_size,e.y1=a.scalefns[d+"f"],e.y2=a.scalefns[d+"f"]),"right"===c&&(e.x1=t(a)-1,e.x2=t(a)-a.rug_buffer_size,e.y1=a.scalefns[d+"f"],e.y2=a.scalefns[d+"f"]),"top"===c&&(e.x1=a.scalefns[d+"f"],e.x2=a.scalefns[d+"f"],e.y1=p(a)+1,e.y2=p(a)+a.rug_buffer_size),"bottom"===c&&(e.x1=a.scalefns[d+"f"],e.x2=a.scalefns[d+"f"],e.y1=n(a)-1,e.y2=n(a)-a.rug_buffer_size),e}function ia(a,b){var c=b.namespace,d=b.position,e=a.processed[c+"_ticks"].length,f=a.processed[c+"_ticks"],g=a.scales[c.toUpperCase()],h={};return"left"===d&&(h.x1=r(a),h.x2=r(a),h.y1=g(f[0]).toFixed(2),h.y2=g(f[e-1]).toFixed(2)),"right"===d&&(h.x1=t(a),h.x2=t(a),h.y1=g(f[0]).toFixed(2),h.y2=g(f[e-1]).toFixed(2)),"top"===d&&(h.x1=r(a),h.x2=t(a),h.y1=p(a),h.y2=p(a)),"bottom"===d&&(h.x1=r(a),h.x2=t(a),h.y1=n(a),h.y2=n(a)),("left"===d||"right"===d)&&(a.axes_not_compact?(h.y1=n(a),h.y2=p(a)):e&&(h.y1=g(f[0]).toFixed(2),h.y2=g(f[e-1]).toFixed(2))),h}function ja(a,b){var c=b.position,d=b.namespace,e=a[d+"ax_tick_length"],f=a.scales[d.toUpperCase()],g={};return"left"===c&&(g.x=r(a)-3*e/2,g.y=function(a){return f(a).toFixed(2)},g.dx=-3,g.dy=".35em",g.textAnchor="end",g.text=function(b){return Aa(a)(b)}),"right"===c&&(g.x=t(a)+3*e/2,g.y=function(a){return f(a).toFixed(2)},g.dx=3,g.dy=".35em",g.textAnchor="start",g.text=function(b){return Aa(a)(b)}),"top"===c&&(g.x=function(a){return f(a).toFixed(2)},g.y=(p(a)-7*e/3).toFixed(2),g.dx=0,g.dy="0em",g.textAnchor="middle",g.text=function(b){return db(a)(b)}),"bottom"===c&&(g.x=function(a){return f(a).toFixed(2)},g.y=(n(a)+7*e/3).toFixed(2),g.dx=0,g.dy=".50em",g.textAnchor="middle",g.text=function(b){return db(a)(b)}),g}function ka(a){var b=a.chart_type;a.processed.xax_format||(a.xax_format?a.processed.xax_format=a.xax_format:"line"===b||"point"===b||"histogram"===b?a.processed.xax_format=db(a):"bar"===b&&(a.processed.xax_format=Ua(a)))}function la(a,b,c){if(b.time_series&&(b.show_years||b.show_secondary_x_label)){var d=kb(b);ma(b,c,a,d.timeframe,d.yformat,d.secondary)}}function ma(a,b,c,d,e,f){var g=f(a.processed.min_x,a.processed.max_x);if(0===g.length){var h=a.scales.X.ticks(a.xax_count)[0];g=[h]}var i=x(c,"mg-year-marker");"default"===d&&a.show_year_markers&&na(a,b,i,g,e),"years"!=d&&oa(a,b,i,g,e)}function na(a,b,c,d){c.selectAll(".mg-year-marker").data(d).enter().append("line").attr("x1",function(b){return a.scales.X(b).toFixed(2)}).attr("x2",function(b){return a.scales.X(b).toFixed(2)}).attr("y1",p(a)).attr("y2",n(a))}function oa(b,c,d,e,f){var g,h,i,j,k,l=c.position,m=c.namespace,o=b.scales[m.toUpperCase()],q=a.select(b.target).select(".mg-x-axis text").node().getBoundingClientRect();"top"===l&&(g=function(a){return o(a).toFixed(2)},h=p(b)-7*b.xax_tick_length/3-q.height,i=".50em",j="middle",k=function(a){return f(new Date(a))}),"bottom"===l&&(g=function(a){return o(a).toFixed(2)},h=n(b)+7*b.xax_tick_length/3+.8*q.height,i=".50em",j="middle",k=function(a){return f(new Date(a))}),d.selectAll(".mg-year-marker").data(e).enter().append("text").attr("x",g).attr("y",h).attr("dy",i).attr("text-anchor",j).text(k)}function pa(b,c,d){var e=d.namespace,f=ja(c,d),g=c.processed[e+"_ticks"],h=b.selectAll(".mg-yax-labels").data(g).enter().append("text").attr("x",f.x).attr("dx",f.dx).attr("y",f.y).attr("dy",f.dy).attr("text-anchor",f.textAnchor).text(f.text);if("x"==e&&(ka(c),c.time_series&&c.european_clock?(h.append("tspan").classed("mg-european-hours",!0).text(function(b,c){var d=new Date(b);return 0===c?a.timeFormat("%H")(d):""}),h.append("tspan").classed("mg-european-minutes-seconds",!0).text(function(a){var b=new Date(a);return":"+c.processed.xax_format(b)})):h.text(function(a){return c.xax_units+c.processed.xax_format(a)}),la(b,c,d)),B(h)){h.filter(function(a,b){return(b+1)%2===0}).remove();var i=H(c.target);i.selectAll(".mg-"+e+"ax-ticks").filter(function(a,b){return(b+1)%2===0}).remove()}}function qa(a,b,c){var d,e,f,g,h=c.namespace,i=c.position,j=b.scales[h.toUpperCase()],k=b.processed[h+"_ticks"],l="mg-"+h+"ax-ticks",m="mg-extended-"+h+"ax-ticks",o=b[h+"_extended_ticks"],q=b[h+"ax_tick_length"];"left"===i&&(d=r(b),e=o?t(b):r(b)-q,f=function(a){return j(a).toFixed(2)},g=function(a){return j(a).toFixed(2)}),"right"===i&&(d=t(b),e=o?r(b):t(b)+q,f=function(a){return j(a).toFixed(2)},g=function(a){return j(a).toFixed(2)}),"top"===i&&(d=function(a){return j(a).toFixed(2)},e=function(a){return j(a).toFixed(2)},f=p(b),g=o?n(b):p(b)-q),"bottom"===i&&(d=function(a){return j(a).toFixed(2)},e=function(a){return j(a).toFixed(2)},f=n(b),g=o?p(b):n(b)+q),a.selectAll("."+l).data(k).enter().append("line").classed(m,o).attr("x1",d).attr("x2",e).attr("y1",f).attr("y2",g)}function ra(a,b,c){var d=c.namespace,e=b.processed[d+"_ticks"].length,f=ia(b,c);b[d+"_extended_ticks"]||b[d+"_extended_ticks"]||!e||a.append("line").attr("x1",f.x1).attr("x2",f.x2).attr("y1",f.y1).attr("y2",f.y2)}function sa(a,b){var c=H(a.target),d=I(a.data),e=c.selectAll("line."+b).data(d);return e.enter().append("svg:line").attr("class",b).attr("opacity",.3),v(e),v(e),e}function ta(a,b){"use strict";a.rug_buffer_size="point"===a.chart_type?a.buffer/2:2*a.buffer/3;var c=sa(a,"mg-"+b.namespace+"-rug"),d=ha(a,b);c.attr("x1",d.x1).attr("x2",d.x2).attr("y1",d.y1).attr("y2",d.y2),z(c,a,"mg-"+b.namespace+"-rug-mono")}function ua(a,b,c){var d=b.namespace,e=b.position,f=a.scales[d.toUpperCase()],g=a.scales[(d+"group").toUpperCase()],h={};return h.cat={},h.group={},"left"===e&&(h.cat.x=s(a)-a.buffer,h.cat.y=function(a){return g(c)+f(a)+f.bandwidth()/2},h.cat.dy=".35em",h.cat.textAnchor="end",h.group.x=s(a)-a.buffer,h.group.y=g(c)+(g.bandwidth?g.bandwidth()/2:0),h.group.dy=".35em",h.group.textAnchor=(a["rotate_"+d+"_labels"],"end")),"right"===e&&(h.cat.x=u(a)-a.buffer,h.cat.y=function(a){return g(c)+f(a)+f.bandwidth()/2},h.cat.dy=".35em",h.cat.textAnchor="start",h.group.x=u(a)-a.buffer,h.group.y=g(c)+(g.bandwidth?g.bandwidth()/2:0),h.group.dy=".35em",h.group.textAnchor="start"),"top"===e&&(h.cat.x=function(a){return g(c)+f(a)+f.bandwidth()/2},h.cat.y=q(a)+a.buffer,h.cat.dy=".35em",h.cat.textAnchor=a["rotate_"+d+"_labels"]?"start":"middle",h.group.x=g(c)+(g.bandwidth?g.bandwidth()/2:0),h.group.y=q(a)+a.buffer,h.group.dy=".35em",h.group.textAnchor=a["rotate_"+d+"_labels"]?"start":"middle"),"bottom"===e&&(h.cat.x=function(a){return g(c)+f(a)+f.bandwidth()/2},h.cat.y=o(a)+a.buffer,h.cat.dy=".35em",h.cat.textAnchor=a["rotate_"+d+"_labels"]?"start":"middle",h.group.x=g(c)+(g.bandwidth?g.bandwidth()/2-f.bandwidth()/2:0),h.group.y=o(a)+a.buffer,h.group.dy=".35em",h.group.textAnchor=a["rotate_"+d+"_labels"]?"start":"middle"),h}function va(a,b){var c=b.namespace,d="mg-"+c+"-axis",e=a.scales[c.toUpperCase()],f=a.scales[(c+"group").toUpperCase()],g=c+"group_accessor",h=H(a.target);w(h,"."+d);var i,j=x(h,d),k=f.domain&&f.domain()?f.domain():["1"];k.forEach(function(d){var f=ua(a,b,d);if(i=x(j,"mg-group-"+L(d)),null!==a[g])var h=i.append("text").classed("mg-barplot-group-label",!0).attr("x",f.group.x).attr("y",f.group.y).attr("dy",f.group.dy).attr("text-anchor",f.group.textAnchor).text(d);else var h=i.selectAll("text").data(e.domain()).enter().append("text").attr("x",f.cat.x).attr("y",f.cat.y).attr("dy",f.cat.dy).attr("text-anchor",f.cat.textAnchor).text(String);a["rotate_"+c+"_labels"]&&xa(h,a["rotate_"+c+"_labels"])})}function wa(a,b){var c,d,e,f,g=b.namespace,h=(a.scalefns[g+"f"],a.scalefns[g+"groupf"],a.scales[(g+"group").toUpperCase()]),i=a.scales[g.toUpperCase()],j=b.position,k=H(a.target),l=h.domain&&h.domain()?h.domain():[null];w(k,".mg-category-guides");var m=x(k,"mg-category-guides");l.forEach(function(b){i.domain().forEach(function(g){("left"===j||"right"===j)&&(c=s(a),d=u(a),e=i(g)+h(b)+i.bandwidth()/2,f=i(g)+h(b)+i.bandwidth()/2),("top"===j||"bottom"===j)&&(c=i(g)+h(b)+i.bandwidth()/2*(null===b),d=i(g)+h(b)+i.bandwidth()/2*(null===b),e=o(a),f=q(a)),m.append("line").attr("x1",c).attr("x2",d).attr("y1",e).attr("y2",f).attr("stroke-dasharray","2,1")});var g=h(b)+i(i.domain()[0])+i.bandwidth()/2*(null===b||"top"!==j&&"bottom"!=j),k=h(b)+i(i.domain()[i.domain().length-1])+i.bandwidth()/2*(null===b||"top"!==j&&"bottom"!=j);("left"===j||"right"===j)&&(x11=s(a),x21=s(a),y11=g,y21=k,x12=u(a),x22=u(a),y12=g,y22=k),("bottom"===j||"top"===j)&&(x11=g,x21=k,y11=o(a),y21=o(a),x12=g,x22=k,y12=q(a),y22=q(a)),m.append("line").attr("x1",x11).attr("x2",x21).attr("y1",y11).attr("y2",y21).attr("stroke-dasharray","2,1"),m.append("line").attr("x1",x12).attr("x2",x22).attr("y1",y12).attr("y2",y22).attr("stroke-dasharray","2,1")})}function xa(b,c){c&&b.attr("transform",function(){var b=a.select(this);return"rotate("+c+" "+b.attr("x")+","+b.attr("y")+")"})}function ya(a){var b={};return b.type="numerical",this.namespace=function(a){return b.namespace=a,this},this.rug=function(a){return b.rug=a,this},this.label=function(a){return b.label=a,this},this.type=function(a){return b.type=a,this},this.position=function(a){return b.position=a,this},this.zeroLine=function(a){return b.zeroLine=a,this},this.draw=function(){return Oc[b.type](a,b),this},this}function za(a){"use strict";if(a.y_rug){a.rug_buffer_size="point"===a.chart_type?a.buffer/2:2*a.buffer/3;var b=y(a,"mg-y-rug");b.attr("x1",a.left+1).attr("x2",a.left+a.rug_buffer_size).attr("y1",a.scalefns.yf).attr("y2",a.scalefns.yf),z(b,a,"mg-y-rug-mono")}}function Aa(b){var c=b.yax_format;return c||("count"===b.format?(b.processed.max_y<1e-4?b.decimals=6:b.processed.max_y<.1&&(b.decimals=4),c=function(c){var d;return d=a.format(1>c&&c>-1&&0!==c?",."+b.decimals+"f":1e3>c?",.0f":",.2s"),b.yax_units_append?d(c)+b.yax_units:b.yax_units+d(c)}):c=function(b){var c=a.format(".0%");return c(b)}),c}function Ba(a){var b=H(a.target),c=a.scales.X.domain();if(0>=c[0]&&c[1]>=0){var d=a.scales.Y.range(),e=a.categorical_groups.length?a.scales.YGROUP(a.categorical_groups[a.categorical_groups.length-1]):a.scales.YGROUP();b.append("svg:line").attr("x1",a.scales.X(0)).attr("x2",a.scales.X(0)).attr("y1",d[0]+q(a)).attr("y2",d[d.length-1]+e).attr("stroke","black").attr("opacity",.2)}}function Ca(a,b){b.y_label&&a.append("text").attr("class","label").attr("x",function(){return-1*(q(b)+(o(b)-q(b))/2)}).attr("y",function(){return b.left/2}).attr("dy","0.4em").attr("text-anchor","middle").text(function(){return b.y_label}).attr("transform",function(){return"rotate(-90)"})}function Da(a,b){var c=b.processed.y_ticks.length;if(!b.x_extended_ticks&&!b.y_extended_ticks&&c){var d,e;b.axes_not_compact&&"bar"!==b.chart_type?(d=b.height-b.bottom,e=b.top):c?(d=b.scales.Y(b.processed.y_ticks[0]).toFixed(2),e=b.scales.Y(b.processed.y_ticks[c-1]).toFixed(2)):(d=0,e=0),a.append("line").attr("x1",b.left).attr("x2",b.left).attr("y1",d).attr("y2",e)}}function Ea(a,b){a.selectAll(".mg-yax-ticks").data(b.processed.y_ticks).enter().append("line").classed("mg-extended-yax-ticks",b.y_extended_ticks).attr("x1",b.left).attr("x2",function(){return b.y_extended_ticks?b.width-b.right:b.left-b.yax_tick_length}).attr("y1",function(a){return b.scales.Y(a).toFixed(2)}).attr("y2",function(a){return b.scales.Y(a).toFixed(2)})}function Fa(a,b){var c=Aa(b);a.selectAll(".mg-yax-labels").data(b.processed.y_ticks).enter().append("text").attr("x",b.left-3*b.yax_tick_length/2).attr("dx",-3).attr("y",function(a){return b.scales.Y(a).toFixed(2)}).attr("dy",".35em").attr("text-anchor","end").text(function(a){var b=c(a);return b})}function Ga(a){a.processed||(a.processed={});var b=H(a.target);if(MG.call_hook("y_axis.process_min_max",a,a.processed.min_y,a.processed.max_y),w(b,".mg-y-axis"),!a.y_axis)return this;var c=x(b,"mg-y-axis");return Ca(c,a),gc(a,"y"),Da(c,a),Ea(c,a),Fa(c,a),a.y_rug&&za(a),this}function Ha(a){var b=H(a.target);w(b,".mg-y-axis");var c,d=x(b,"mg-y-axis");(a.categorical_groups.length?a.categorical_groups:["1"]).forEach(function(b){if(c=x(d,"mg-group-"+L(b)),null!==a.ygroup_accessor)Ja(c,b,a);else{var e=Ia(c,b,a);A(e,a.rotate_y_labels)}})}function Ia(a,b,c){return a.selectAll("text").data(c.scales.Y.domain()).enter().append("svg:text").attr("x",c.left-c.buffer).attr("y",function(a){return c.scales.YGROUP(b)+c.scales.Y(a)+c.scales.Y.bandwidth()/2}).attr("dy",".35em").attr("text-anchor","end").text(String)}function Ja(a,b,c){a.append("svg:text").classed("mg-barplot-group-label",!0).attr("x",c.left-c.buffer).attr("y",c.scales.YGROUP(b)+c.scales.YGROUP.bandwidth()/2).attr("dy",".35em").attr("text-anchor","end").text(b)}function Ka(a){var b=H(a.target),c=a.scales.YGROUP.domain();c[0],c[c.length-1],b.select(".mg-category-guides").selectAll("mg-group-lines").data(c).enter().append("line").attr("x1",s(a)).attr("x2",s(a)).attr("y1",function(b){return a.scales.YGROUP(b)}).attr("y2",function(b){return a.scales.YGROUP(b)+a.ygroup_height}).attr("stroke-width",1)}function La(a){var b=H(a.target),c=[];a.data[0].forEach(function(d){-1===c.indexOf(d[a.y_accessor])&&b.select(".mg-category-guides").append("line").attr("x1",s(a)).attr("x2",u(a)).attr("y1",a.scalefns.yf(d)+a.scalefns.ygroupf(d)).attr("y2",a.scalefns.yf(d)+a.scalefns.ygroupf(d)).attr("stroke-dasharray","2,1")})}function Ma(a){return a.y_axis?(Ha(a),a.show_bar_zero&&Ba(a),a.ygroup_accessor&&Ka(a),a.y_categorical_show_guides&&La(a),this):this}function Na(a){"use strict";if(a.x_rug){a.rug_buffer_size="point"===a.chart_type?a.buffer/2:a.buffer;var b=y(a,"mg-x-rug");b.attr("x1",a.scalefns.xf).attr("x2",a.scalefns.xf).attr("y1",a.height-a.bottom-a.rug_buffer_size).attr("y2",a.height-a.bottom),z(b,a,"mg-x-rug-mono")}}function Oa(a){a.processed||(a.processed={})}function Pa(a){"use strict";var b=H(a.target);if(Oa(a),pb(a),w(b,".mg-x-axis"),!a.x_axis)return this;var c=x(b,"mg-x-axis");return eb(c,a),hb(c,a),a.x_label&&Ta(c,a),a.x_rug&&Na(a),this}function Qa(a){var b=H(a.target),c=0;"bar"===a.chart_type&&(c=a.buffer+5),mg_add_categorical_scale(a,"X",a.categorical_variables.reverse(),a.left,u(a)-c),_(a,"xf","X","value"),w(b,".mg-x-axis");var d=x(b,"mg-x-axis");return a.x_axis?(Ra(d,a,c),this):this}function Ra(a,b,c){var d=a.selectAll("text").data(b.categorical_variables).enter().append("text");d.attr("x",function(a){return b.scales.X(a)+b.scales.X.bandwidth()/2+b.buffer*b.bar_outer_padding_percentage+c/2}).attr("y",o(b)).attr("dy",".35em").attr("text-anchor","middle").text(String),b.truncate_x_labels&&d.each(function(a){var c=this,d=b.scales.X.bandwidth();W(c,a,d)}),A(d,b.rotate_x_labels)}function ea(b){var c;return null===b.color_domain?"number"===b.color_type?c=a.extent(b.data[0],function(a){return a[b.color_accessor]}):"category"===b.color_type&&(c=a.set(b.data[0].map(function(a){return a[b.color_accessor]})).values(),c.sort()):c=b.color_domain,c}function fa(a){var b;return b=null===a.color_range?"number"===a.color_type?["blue","red"]:null:a.color_range}function Sa(a){var b;return b=null===a.size_range?[1,5]:a.size_range}function Ta(b,c){c.x_label&&b.append("text").attr("class","label").attr("x",function(){return s(c)+(u(c)-s(c))/2}).attr("dx",null!=c.x_label_nudge_x?c.x_label_nudge_x:0).attr("y",function(){var b=a.select(c.target).select(".mg-x-axis text").node().getBoundingClientRect();return n(c)+c.xax_tick_length*(7/3)+.8*b.height+10}).attr("dy",".5em").attr("text-anchor","middle").text(function(){return c.x_label})}function Ua(b){return function(c){if(1>c&&c>-1&&0!==c)return b.xax_units+c.toFixed(b.decimals);var d=a.format(",.0f");return b.xax_units+d(c)}}function Va(a){var b;return b=Wa(a)?"millis":Xa(a)?"seconds":Ya(a)?"less-than-a-day":Za(a)?"four-days":$a(a)?"many-days":_a(a)?"many-months":ab(a)?"years":"default"}function Wa(a){return 10>a}function Xa(a){return 60>a}function Ya(a){return 24>=a/3600}function Za(a){return 96>=a/3600}function $a(a){return 93>=a/86400}function _a(a){return 730>a/86400}function ab(a){return a/86400>=730}function bb(a,b){var c;return c=Wa(b)?MG.time_format(a,"%M:%S.%L"):Xa(b)?MG.time_format(a,"%M:%S"):Ya(b)?MG.time_format(a,"%H:%M"):Za(b)?MG.time_format(a,"%H:%M"):$a(b)?MG.time_format(a,"%b %d"):_a(b)?MG.time_format(a,"%b"):MG.time_format(a,"%Y")}function cb(a){var b,c,d;a.time_series&&(b=(a.processed.max_x-a.processed.min_x)/1e3,d=Va(b),c=bb(a.utc_time,b)),a.processed.main_x_time_format=c,a.processed.x_time_frame=d}function db(b){if(b.xax_format)return b.xax_format;var c=b.processed.original_data||b.data,d=I(c)[0],e=d[b.processed.original_x_accessor||b.x_accessor];return void 0===e&&(e=d),function(c){if(cb(b),Q(e))return b.processed.main_x_time_format(new Date(c));if("number"==typeof e){var d,f=c%1!==0;return d=a.format(f?",."+b.decimals+"f":1e3>c?",.0f":",.2s"),b.xax_units+d(c)}return b.xax_units+c}}function eb(a,b){gc(b,"x"),fb(b,a),gb(b,a)}function fb(a,b){var c=(a.processed.x_ticks.length,a.scales.X.ticks(a.xax_count).length-1);a.x_extended_ticks||b.append("line").attr("x1",function(){return 0===a.xax_count?s(a):a.axes_not_compact&&"bar"!==a.chart_type?a.left:a.scales.X(a.scales.X.ticks(a.xax_count)[0]).toFixed(2)}).attr("x2",function(){return 0===a.xax_count||a.axes_not_compact&&"bar"!==a.chart_type?t(a):a.scales.X(a.scales.X.ticks(a.xax_count)[c]).toFixed(2)}).attr("y1",a.height-a.bottom).attr("y2",a.height-a.bottom)}function gb(a,b){b.selectAll(".mg-xax-ticks").data(a.processed.x_ticks).enter().append("line").attr("x1",function(b){return a.scales.X(b).toFixed(2)}).attr("x2",function(b){return a.scales.X(b).toFixed(2)}).attr("y1",a.height-a.bottom).attr("y2",function(){return a.x_extended_ticks?a.top:a.height-a.bottom+a.xax_tick_length}).attr("class",function(){return a.x_extended_ticks?"mg-extended-xax-ticks":void 0}).classed("mg-xax-ticks",!0)}function hb(a,b){ib(b,a),jb(b,a)}function ib(b,c){var d=c.selectAll(".mg-xax-labels").data(b.processed.x_ticks).enter().append("text").attr("x",function(a){return b.scales.X(a).toFixed(2)}).attr("y",(b.height-b.bottom+7*b.xax_tick_length/3).toFixed(2)).attr("dy",".50em").attr("text-anchor","middle");if(b.time_series&&b.european_clock?(d.append("tspan").classed("mg-european-hours",!0).text(function(b,c){var d=new Date(b);return 0===c?a.timeFormat("%H")(d):""}),d.append("tspan").classed("mg-european-minutes-seconds",!0).text(function(a){var c=new Date(a);return":"+b.processed.xax_format(c)})):d.text(function(a){return b.xax_units+b.processed.xax_format(a)}),B(d)){d.filter(function(a,b){return(b+1)%2===0}).remove();var e=H(b.target);e.selectAll(".mg-xax-ticks").filter(function(a,b){return(b+1)%2===0}).remove()}}function jb(a,b){if(a.time_series&&(a.show_years||a.show_secondary_x_label)){var c=kb(a);lb(a,b,c.timeframe,c.yformat,c.secondary)}}function kb(b){var c={};switch(c.timeframe=b.processed.x_time_frame,c.timeframe){case"millis":case"seconds":c.secondary=a.timeDays,c.yformat=b.european_clock?MG.time_format(b.utc_time,"%b %d"):MG.time_format(b.utc_time,"%I %p");break;case"less-than-a-day":c.secondary=a.timeDays,c.yformat=MG.time_format(b.utc_time,"%b %d");break;case"four-days":c.secondary=a.timeDays,c.yformat=MG.time_format(b.utc_time,"%b %d");break;case"many-days":c.secondary=a.timeYears,c.yformat=MG.time_format(b.utc_time,"%Y");break;case"many-months":c.secondary=a.timeYears,c.yformat=MG.time_format(b.utc_time,"%Y");break;default:c.secondary=a.timeYears,c.yformat=MG.time_format(b.utc_time,"%Y")}return c}function lb(a,b,c,d,e){var f=e(a.processed.min_x,a.processed.max_x);if(0===f.length){var g=a.scales.X.ticks(a.xax_count)[0];f=[g]}var h=x(b,"mg-year-marker");"default"===c&&a.show_year_markers&&mb(a,h,f,d),"years"!=c&&nb(a,h,f,d)}function mb(a,b,c){b.selectAll(".mg-year-marker").data(c).enter().append("line").attr("x1",function(b){return a.scales.X(b).toFixed(2)}).attr("x2",function(b){return a.scales.X(b).toFixed(2)}).attr("y1",p(a)).attr("y2",n(a))}function nb(b,c,d,e){c.selectAll(".mg-year-marker").data(d).enter().append("text").attr("x",function(a){return b.scales.X(a).toFixed(2)}).attr("y",function(){var c=a.select(b.target).select(".mg-x-axis text").node().getBoundingClientRect();return n(b)+7*b.xax_tick_length/3+.8*c.height}).attr("dy",".50em").attr("text-anchor","middle").text(function(a){return e(new Date(a))})}function ob(a){a.xax_count=2}function pb(a){var b=a.chart_type;a.processed.xax_format||(a.xax_format?a.processed.xax_format=a.xax_format:"line"===b||"point"===b||"histogram"===b?a.processed.xax_format=db(a):"bar"===b&&(a.processed.xax_format=Ua(a)))}function qb(a){var b={target:null,title:null,description:null};return a||(a={}),a.processed||(a.processed={}),a=P(a,b)}function rb(a){var b=I(a.processed.original_data||a.data)[0];a.time_series=Q(b[a.processed.original_x_accessor||a.x_accessor])}function sb(a){var b=a.width;a.full_width&&(b=N(a.target)),"categorical"===a.x_axis_type&&null===b&&(b=Hb(a,"x")),a.width=b}function tb(a){var b=a.height;a.full_height&&(b=O(a.target)),"categorical"===a.y_axis_type&&null===b&&(b=Hb(a,"y")),a.height=b}function ub(a,b){(!a.selectAll(".mg-main-line").empty()&&"line"!==b.chart_type||!a.selectAll(".mg-points").empty()&&"point"!==b.chart_type||!a.selectAll(".mg-histogram").empty()&&"histogram"!==b.chart_type||!a.selectAll(".mg-barplot").empty()&&"bar"!==b.chart_type)&&a.remove();
}function vb(b,c){return H(c.target).empty()&&(b=a.select(c.target).append("svg").classed("linked",c.linked).attr("width",c.width).attr("height",c.height)),b}function wb(a,b){a.selectAll(".mg-clip-path").remove(),a.append("defs").attr("class","mg-clip-path").append("clipPath").attr("id","mg-plot-window-"+K(b.target)).append("svg:rect").attr("x",r(b)).attr("y",p(b)).attr("width",b.width-b.left-b.right-b.buffer).attr("height",b.height-b.top-b.bottom-b.buffer+1)}function xb(a,b){b.width!==+a.attr("width")&&a.attr("width",b.width),b.height!==+a.attr("height")&&a.attr("height",b.height)}function yb(a,b){a.attr("viewBox","0 0 "+b.width+" "+b.height),(b.full_width||b.full_height)&&a.attr("preserveAspectRatio","xMinYMin meet")}function zb(a){a.classed("mg-missing",!1),a.selectAll(".mg-missing-text").remove(),a.selectAll(".mg-missing-pane").remove()}function Ab(a,b){var c=0;if(a.selectAll(".mg-main-line").nodes().length>=b.data.length)if(b.custom_line_color_map.length>0){var d=function(a){for(var b=Array(a),c=0;c<b.length;c++)b[c]=c+1;return b},e=U(d(b.max_data_size),b.custom_line_color_map);for(c=0;c<e.length;c++)a.selectAll(".mg-main-line.mg-line"+e[c]+"-color").remove()}else{var f=b.data.length,g=a.selectAll(".mg-main-line").nodes()?a.selectAll(".mg-main-line").nodes().length:0;for(c=g;c>f;c--)a.selectAll(".mg-main-line.mg-line"+c+"-color").remove()}}function Bb(a,b){return a.empty()?void console.warn('The specified target element "'+b.target+'" could not be found in the page. The chart will not be rendered.'):void 0}function Cb(a,b){var c="x"===b?a.width:a.height;Db(a,b),Eb(a,b),Fb(a,b,c),c&&Gb(a,b)}function Db(b,c){var d=c+"group_accessor",e=b[d];if(b.categorical_groups=[],e){var f=b.data[0];b.categorical_groups=a.set(f.map(function(a){return a[e]})).values()}}function Eb(b,c){var d=c+"group_accessor",e=b[d];if(b.total_bars=b.data[0].length,e){var f=m(l(b.data[0],e));f=a.max(Object.keys(f).map(function(a){return f[a]})),b.bars_per_group=f}else b.bars_per_group=b.data[0].length}function Fb(a,b,c){var d=b+"group_height";if(c){var e="y"===b?(a.height-a.top-a.bottom-2*a.buffer)/(a.categorical_groups.length||1):(a.width-a.left-a.right-2*a.buffer)/(a.categorical_groups.length||1);a[d]=e}else{var f=(1+a[b+"_padding_percentage"])*a.bar_thickness;a[d]=a.bars_per_group*f+2*a[b+"_outer_padding_percentage"]*f}}function Gb(a,b){var c=a[b+"group_height"]/(a.bars_per_group+a[b+"_outer_padding_percentage"]);a.bar_thickness=c-c*a[b+"_padding_percentage"]}function Hb(a,b){var c=a[b+"group_height"]*(a.categorical_groups.length||1),d="y"===b?a.top+a.bottom+2*a.buffer:a.left+a.right+2*a.buffer;return c+d+a.categorical_groups.length*a[b+"group_height"]*(a[b+"group_padding_percentage"]+a[b+"group_outer_padding_percentage"])}function Ib(b){"use strict";b=arguments[0],b=qb(b);var c=a.select(b.target);Bb(c,b);var d=c.selectAll("svg");return"categorical"===b.y_axis_type&&Cb(b,"y"),"categorical"===b.x_axis_type&&Cb(b,"x"),rb(b),sb(b),tb(b),ub(d,b),d=vb(d,b),wb(d,b),xb(d,b),yb(d,b),zb(d),Z(b),Ab(d,b),this}function Jb(a){return a.label}function Kb(a){a.selectAll(".mg-markers").remove(),a.selectAll(".mg-baselines").remove()}function Lb(a){return function(b){return a.scales.X(b[a.x_accessor])>=s(a)&&a.scales.X(b[a.x_accessor])<=u(a)}}function Mb(a){return function(b){return a.scales.X(b[a.x_accessor])}}function Nb(a){var b=Mb(a);return function(a){return b(a).toFixed(2)}}function Ob(a){var b=a.scales.Y;return function(a){return b(a.value).toFixed(2)}}function Pb(a,b,c,d,e,f){var g;a&&(g=d.append("g").attr("class",b),e(g,c),f(g,c))}function Qb(a,b){Pb(a.markers,"mg-markers",a,b,Sb,Tb)}function Rb(a,b){Pb(a.baselines,"mg-baselines",a,b,Ub,Vb)}function Sb(a,b){var c=Nb(b);a.selectAll(".mg-markers").data(b.markers.filter(Lb(b))).enter().append("line").attr("x1",c).attr("x2",c).attr("y1",b.top).attr("y2",o(b)).attr("class",function(a){return a.lineclass}).attr("stroke-dasharray","3,1")}function Tb(b,c){b.selectAll(".mg-markers").data(c.markers.filter(Lb(c))).enter().append("text").attr("class",function(a){return a.textclass||""}).classed("mg-marker-text",!0).attr("x",Mb(c)).attr("y","bottom"===c.x_axis_position?.95*p(c):n(c)+c.buffer).attr("text-anchor","middle").text(Jb).each(function(b){b.click&&a.select(this).style("cursor","pointer").on("click",b.click)}),C(b.selectAll(".mg-marker-text").nodes(),c)}function Ub(a,b){var c=Ob(b);a.selectAll(".mg-baselines").data(b.baselines).enter().append("line").attr("x1",s(b)).attr("x2",u(b)).attr("y1",c).attr("y2",c)}function Vb(a,b){var c=Ob(b);a.selectAll(".mg-baselines").data(b.baselines).enter().append("text").attr("x",u(b)).attr("y",c).attr("dy",-3).attr("text-anchor","end").text(Jb)}function Wb(a){"use strict";var b=H(a.target);return Kb(b),Qb(a,b),Rb(a,b),this}function Xb(a){a.selectAll(".mg-active-datapoint-container").selectAll("*").remove()}function Yb(b,c){b.select(".mg-active-datapoint").remove();var d="right"===c.mouseover_align?"end":"left"===c.mouseover_align?"start":"middle",e="right"===c.mouseover_align?u(c):"left"===c.mouseover_align?s(c):(c.width-c.left-c.right)/2+c.left,f=b.select(".mg-active-datapoint-container").append("text").attr("class","mg-active-datapoint").attr("xml:space","preserve").attr("text-anchor",d),g=.75,h="bottom"===c.x_axis_position?p(c)*g:n(c)+3*c.buffer;if(c.markers){var i;b.selectAll(".mg-marker-text").each(function(){i?i!==a.select(this).attr("y")&&(g=.56):i=a.select(this).attr("y")})}f.attr("transform","translate("+e+","+h+")")}function Zb(a,b){var c="",d=null;return 3===arguments.length&&(d=arguments[2]),c=a.append("tspan").text(b),null!==d&&c.classed(d,!0),this.tspan=c,this.bold=function(){return this.tspan.attr("font-weight","bold"),this},this.font_size=function(a){return this.tspan.attr("font-size",a),this},this.x=function(a){return this.tspan.attr("x",a),this},this.y=function(a){return this.tspan.attr("y",a),this},this.elem=function(){return this.tspan},this}function $b(a){var b=a.select(".mg-active-datapoint");return b.selectAll("*").remove(),b}function _b(a,b,c){var d=1.1;this.rargs=c;var e=b.append("tspan").attr("x",0).attr("y",a*d+"em");return this.text=function(a){return Zb(e,a)},this}function ac(a,b){return this.row_number=0,this.rargs=b,Yb(b.svg,a),this.text_container=$b(b.svg),this.mouseover_row=function(a){var b=this,c=_b(b.row_number,b.text_container,a);return b.row_number+=1,c},this}function bc(){function b(){e.forEach(function(b){var c=a.select(b).select("svg");if(!c.empty()&&(c.node().parentNode.offsetWidth>0||c.node().parentNode.offsetHeight>0)){var d=0!==c.attr("width")?c.attr("height")/c.attr("width"):0,e=N(b);c.attr("width",e),c.attr("height",d*e)}})}function c(a){var c=e.indexOf(a);-1!==c&&e.splice(c,1),0===e.length&&window.removeEventListener("resize",b,!0)}var d,e=[];return"undefined"!=typeof MutationObserver?d=MutationObserver:"undefined"!=typeof WebKitMutationObserver&&(d=WebKitMutationObserver),{add_target:function(f){if(0===e.length&&window.addEventListener("resize",b,!0),-1===e.indexOf(f)&&(e.push(f),d)){var g=new d(function(b){var d=a.select(f).node();(!d||b.some(function(a){for(var b=0;b<a.removedNodes.length;b++)if(a.removedNodes[b]===d)return!0}))&&(g.disconnect(),c(f))});g.observe(a.select(f).node().parentNode,{childList:!0})}}}}function cc(a){dc(a)}function dc(a){(a.full_width||a.full_height)&&Pc.add_target(a.target)}function ec(a,b,c){var d=ac(a,{svg:b}),e=d.mouseover_row();if(null!==a.color_accessor&&"category"===a.color_type){var f=c[a.color_accessor];e.text(f+"  ").bold().elem().attr("fill",a.scalefns.colorf(c))}fc(a,e.text("●   ").elem(),c),e.text(Dc(a,c)),e.text(Ec(a,c,a.time_series===!1))}function fc(a,b,c){null!==a.color_accessor?(b.attr("fill",a.scalefns.colorf(c)),b.attr("stroke",a.scalefns.colorf(c))):b.classed("mg-points-mono",!0)}function gc(a,b){function c(a){return 1e3===a?3:1e6===a?7:Math.log(a)/Math.LN10}var d,e,f;"x"===b?(d=a.x_accessor,e=a.scales.X.ticks(a.xax_count),f=a.processed.max_x):"y"===b&&(d=a.y_accessor,e=a.scales.Y.ticks(a.yax_count),f=a.processed.max_y),("x"===b&&"log"===a.x_scale_type||"y"===b&&"log"===a.y_scale_type)&&(e=e.filter(function(a){return Math.abs(c(a))%1<1e-6||Math.abs(c(a))%1>1-1e-6}));var g=e.length,h=!0;a.data.forEach(function(a){a.forEach(function(a){return a[d]%1!==0?(h=!1,!1):void 0})}),h&&g>f&&"count"===a.format&&(e=e.filter(function(a){return a%1===0})),"x"===b?a.processed.x_ticks=e:"y"===b&&(a.processed.y_ticks=e)}function hc(a){"use strict";if(a.data=MG.clone(a.data),a.single_object=!1,a.array_of_objects=!1,a.array_of_arrays=!1,a.nested_array_of_arrays=!1,a.nested_array_of_objects=!1,i(a.data)?(a.nested_array_of_objects=a.data.map(function(a){return k(a)}),a.nested_array_of_arrays=a.data.map(function(a){return i(a)})):(a.array_of_objects=j(a.data),a.array_of_arrays=i(a.data)),"line"===a.chart_type?(a.array_of_objects||a.array_of_arrays)&&(a.data=[a.data]):S(a.data[0])||(a.data=[a.data]),jc(a),kc(a),void 0!==a.color&&(a.colors=a.color),null!==a.colors&&"string"==typeof a.colors&&(a.colors=[a.colors]),"line"===a.chart_type&&a.x_sort===!0)for(var b=0;b<a.data.length;b++)a.data[b].sort(function(b,c){return b[a.x_accessor]-c[a.x_accessor]});return this}function ic(a,b){S(a[b])&&(a.data=a.data.map(function(c){return a[b].map(function(a){return c.map(function(c){return c=MG.clone(c),void 0===c[a]?void 0:(c["multiline_"+b]=c[a],c)}).filter(function(a){return void 0!==a})})})[0],a[b]="multiline_"+b)}function jc(a){ic(a,"x_accessor")}function kc(a){ic(a,"y_accessor")}function lc(b){"use strict";var c,d=a.sum(b.data.map(function(a){return a.length>0&&Q(a[0][b.x_accessor])}))>0;if((b.missing_is_zero||b.missing_is_hidden)&&"line"===b.chart_type&&d)for(var e=0;e<b.data.length;e++)if(b.data[e].length>1){var f=b.data[e][0],g=b.data[e][b.data[e].length-1],h=[],i=MG.clone(f[b.x_accessor]).setDate(f[b.x_accessor].getDate()+1),j=b.min_x?b.min_x:i,k=b.max_x?b.max_x:g[b.x_accessor];if(c=Va((k-j)/1e3),-1!==["four-days","many-days","many-months","years","default"].indexOf(c)&&null===b.missing_is_hidden_accessor)for(var l=new Date(j);k>=l;l.setDate(l.getDate()+1)){var m={};l.setHours(0,0,0,0),Date.parse(l)===Date.parse(new Date(i))&&h.push(MG.clone(b.data[e][0]));var n=null;b.data[e].forEach(function(a){return Date.parse(a[b.x_accessor])===Date.parse(new Date(l))?(n=a,!1):void 0}),n?n[b.missing_is_hidden_accessor]||null===n[b.y_accessor]?(n._missing=!0,h.push(n)):h.push(n):(m[b.x_accessor]=new Date(l),m[b.y_accessor]=0,m._missing=!0,h.push(m))}else for(var o=0;o<b.data[e].length;o+=1){var p=MG.clone(b.data[e][o]);p._missing=b.data[e][o][b.missing_is_hidden_accessor],h.push(p)}b.data[e]=h}return this}function mc(b){"use strict";var c,d=b.data[0];if(b.binned===!1){if("object"==typeof d[0])c=d.map(function(a){return a[b.x_accessor]});else{if("number"!=typeof d[0])return void console.log("TypeError: expected an array of numbers, found "+typeof d[0]);c=d}var e=a.histogram();b.bins&&e.thresholds(b.bins);var f=e(c);b.processed_data=f.map(function(a){return{x:a.x0,y:a.length}})}else{b.processed_data=d.map(function(a){return{x:a[b.x_accessor],y:a[b.y_accessor]}});for(var g,h,i=0;i<b.processed_data.length;i++)g=b.processed_data[i],i===b.processed_data.length-1?g.dx=b.processed_data[i-1].dx:(h=b.processed_data[i+1],g.dx=h.x-g.x)}return b.processed||(b.processed={}),b.processed.original_data=b.data,b.processed.original_x_accessor=b.x_accessor,b.processed.original_y_accessor=b.y_accessor,b.data=[b.processed_data],b.x_accessor=b.processed_x_accessor,b.y_accessor=b.processed_y_accessor,this}function nc(a){"use strict";return"vertical"===a.bar_orientation?a.x_accessor:a.y_accessor,"vertical"===a.bar_orientation?a.y_accessor:a.x_accessor,this}function oc(a){"use strict";var b=a.data[0],c=b.map(function(b){return b[a.x_accessor]}),d=b.map(function(b){return b[a.y_accessor]});return a.least_squares&&(a.ls_line=tc(c,d)),this}function pc(b){var c=H(b.target),d=b.data[0],e=a.min(d,function(a){return a[b.x_accessor]}),f=a.max(d,function(a){return a[b.x_accessor]});a.select(b.target).selectAll(".mg-least-squares-line").remove(),c.append("svg:line").attr("x1",b.scales.X(e)).attr("x2",b.scales.X(f)).attr("y1",b.scales.Y(b.ls_line.fit(e))).attr("y2",b.scales.Y(b.ls_line.fit(f))).attr("class","mg-least-squares-line")}function qc(b){var c=H(b.target),d=b.lowess_line,e=a.svg.line().x(function(a){return b.scales.X(a.x)}).y(function(a){return b.scales.Y(a.y)}).interpolate(b.interpolate);c.append("path").attr("d",e(d)).attr("class","mg-lowess-line")}function rc(b,c,d,e){var f,g,h=[];for(a.mean(c),g=0;g<b.length;g+=1)h.push(1);f=Ac(b,c,d,e,h);var i=f.x,j=f.y;for(g=0;100>g;g+=1){h=a.zip(j,c).map(function(a){return Math.abs(a[1]-a[0])});var k=a.quantile(h.sort(),.5);h=h.map(function(a){return vc(a/(6*k))}),f=Ac(b,c,d,e,h),i=f.x,j=f.y}return a.zip(i,j).map(function(a){var b={};return b.x=a[0],b.y=a[1],b})}function sc(a,b,c,d){for(var e=[],f=0;f<a.length;f+=1)e.push(1);Ac(a,b,c,d,e)}function tc(b,c){var d,e,f,g;b.length,d=Q(b[0])?b.map(function(a){return a.getTime()}):b,e=Q(c[0])?c.map(function(a){return a.getTime()}):c;for(var h=a.mean(d),i=a.mean(e),j=0,k=0,l=0;l<d.length;l++)f=d[l],g=e[l],j+=(f-h)*(g-i),k+=(f-h)*(f-h);var m=j/k,n=i-m*h;return{x0:n,beta:m,fit:function(a){return n+a*m}}}function uc(a,b){return 0>a||a>1?0:Math.pow(1-Math.pow(a,b),b)}function vc(a){return uc(a,2)}function wc(a){return uc(a,3)}function xc(b){var c=a.sum(b.map(function(a){return a.w}));return{xbar:a.sum(b.map(function(a){return a.w*a.x}))/c,ybar:a.sum(b.map(function(a){return a.w*a.y}))/c}}function yc(b,c,d){var e=a.sum(b.map(function(a){return Math.pow(a.w,2)*(a.x-c)*(a.y-d)})),f=a.sum(b.map(function(a){return Math.pow(a.w,2)*Math.pow(a.x-c,2)}));return e/f}function zc(a){var b,c,d=xc(a);c=d.xbar,b=d.ybar;var e=yc(a,c,b);return{beta:e,xbar:c,ybar:b,x0:b-e*c}}function Ac(b,c,d,e,f){var g=Math.floor(b.length*d),h=b.slice();h.sort(function(a,b){return b>a?-1:a>b?1:0});for(var i,j,k,l,m,n=a.quantile(h,.98),o=a.quantile(h,.02),p=a.zip(b,c,f).sort(),q=Math.abs(n-o)/e,r=o,s=n,t=a.range(r,s,q),u=[],v=0;v<t.length;v+=1){j=t[v],i=p.map(function(a){return[Math.abs(a[0]-j),a[0],a[1],a[2]]}).sort().slice(0,g),m=a.max(i)[0],i=i.map(function(a){return{w:wc(a[0]/m)*a[3],x:a[1],y:a[2]}});var w=zc(i);l=w.x0,k=w.beta,u.push(l+k*j)}return{x:t,y:u}}function Bc(b){var c;return c="count"===b.format?function(c){var d,e=c%1!==0;return d=a.format(e?",."+b.decimals+"f":",.0f"),b.yax_units_append?d(c)+b.yax_units:b.yax_units+d(c)}:function(c){var d=(b.decimals?"."+b.decimals:"")+"%",e=a.format(d);return e(c)}}function Cc(a,b,d,e,f){var g,h,i=c(a);return h="string"==typeof b[e]?function(a){return a}:Bc(a),g=null!==d?f?Qc(d,b,e,a.utc):Rc(d,b,e):f?i(new Date(+b[e]))+"  ":(a.time_series?"":e+": ")+h(b[e])+"   "}function Dc(a,b){return Cc(a,b,a.x_mouseover,a.x_accessor,a.time_series)}function Ec(a,b){return Cc(a,b,a.y_mouseover,a.y_accessor,!1)}function Fc(a,b){return Cc(a,b,a.x_mouseover,"key",a.time_series)}function Gc(b,c){return function(){for(var d=this,e=d.cloneNode(),f=d.getTotalLength()||0,g=(e.setAttribute("d",b),e).getTotalLength()||0,h=[0],i=0,j=c/Math.max(f,g);(i+=j)<1;)h.push(i);h.push(1);var k=h.map(function(b){var c=d.getPointAtLength(b*f),h=e.getPointAtLength(b*g);return a.interpolate([c.x,c.y],[h.x,h.y])});return function(a){return 1>a?"M"+k.map(function(b){return b(a)}).join("L"):b}}}function Hc(b){var c=MG.virtual_window,d=a.select(c.document),e=c.document.createElement("div"),f=global.d3,g=global.window,h=global.document;global.d3=d,global.window=c,global.document=c.document;var i;try{b(e)}catch(a){i=a}if(global.d3=f,global.window=g,global.document=h,i)throw i;return d.select(function(){return e}).html()}function Ic(b){var c=document.createElement("div");return b(c),a.select(c).html()}function Jc(a){switch(typeof window){case"undefined":return Hc(a);default:return Ic(a)}}function Kc(a,b){if(!MG.virtual_window||b){var c=a.jsdom({html:"",features:{QuerySelector:!0}});MG.virtual_window=c.defaultView}}function Lc(b){console.error("ERROR : ",b.target," : ",b.error),a.select(b.target).select(".mg-chart-title").append("tspan").attr("class","fa fa-x fa-exclamation-circle mg-warning").attr("dx","0.3em").text("")}function Mc(a){console.error("INTERNAL ERROR : ",a.target," : ",a.internal_error)}("undefined"==typeof window?global:window).MG={version:"2.11"},MG.convert={},MG.convert.date=function(b,c,d){d=void 0===d?"%Y-%m-%d":d;var e=a.timeParse(d);return b=b.map(function(a){return a[c]=e(a[c].trim()),a})},MG.convert.number=function(a,b){return a=a.map(function(a){return a[b]=+a[b],a})},MG.time_format=function(b,c){return b?a.utcFormat(c):a.timeFormat(c)};var Nc=function(a,b,c){var d={};if(null===a)return a;if(Array.prototype.forEach&&a.forEach===Array.prototype.forEach)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(c,a[e],e,a)===d)return}else for(var g in a)if(b.call(c,a[g],g,a)===d)return;return a};MG.merge_with_defaults=P,MG.clone=function(a){var b;if(null===a||"object"!=typeof a)return a;if(Q(a))return b=new Date,b.setTime(a.getTime()),b;if(S(a)){b=[];for(var c=0,d=a.length;d>c;c++)b[c]=MG.clone(a[c]);return b}if(R(a)){b={};for(var e in a)a.hasOwnProperty(e)&&(b[e]=MG.clone(a[e]));return b}throw Error("Unable to copy obj! Its type isn't supported.")},MG.arr_diff=U,MG.warn_deprecation=V,MG.truncate_text=W,MG.wrap_text=X,MG.register=Y,MG._hooks={},MG.add_hook=function(a,b,c){var d;MG._hooks[a]||(MG._hooks[a]=[]),d=MG._hooks[a];var e=d.filter(function(a){return a.func===b}).length>0;if(e)throw"That function is already registered.";d.push({func:b,context:c})},MG.call_hook=function(a){var b,c=MG._hooks[a],d=[].slice.apply(arguments,[1]);return c&&c.forEach(function(a){if(a.func){var c=b||d;c&&c.constructor!==Array&&(c=[c]),c=[].concat.apply([],c),b=a.func.apply(a.context,c)}}),b||d},MG.globals={},MG.deprecations={rollover_callback:{replacement:"mouseover",version:"2.0"},rollout_callback:{replacement:"mouseout",version:"2.0"},x_rollover_format:{replacement:"x_mouseover",version:"2.10"},y_rollover_format:{replacement:"y_mouseover",version:"2.10"},show_years:{replacement:"show_secondary_x_label",version:"2.1"},xax_start_at_min:{replacement:"axes_not_compact",version:"2.7"},interpolate_tension:{replacement:"interpolate",version:"2.10"}},MG.globals.link=!1,MG.globals.version="1.1",MG.charts={},MG.data_graphic=function(b){"use strict";var c={missing_is_zero:!1,missing_is_hidden:!1,missing_is_hidden_accessor:null,legend:"",legend_target:"",error:"",animate_on_load:!1,top:65,title_y_position:10,center_title_full_width:!1,bottom:45,right:10,left:50,buffer:8,width:350,height:220,full_width:!1,full_height:!1,small_height_threshold:120,small_width_threshold:160,xax_count:6,xax_tick_length:5,axes_not_compact:!0,yax_count:3,yax_tick_length:5,x_extended_ticks:!1,y_extended_ticks:!1,y_scale_type:"linear",max_x:null,max_y:null,min_x:null,min_y:null,min_y_from_data:!1,point_size:2.5,x_accessor:"date",xax_units:"",x_label:"",x_sort:!0,x_axis:!0,y_axis:!0,x_axis_position:"bottom",y_axis_position:"left",x_axis_type:null,y_axis_type:null,ygroup_accessor:null,xgroup_accessor:null,y_padding_percentage:.05,y_outer_padding_percentage:.1,ygroup_padding_percentage:.25,ygroup_outer_padding_percentage:0,x_padding_percentage:.05,x_outer_padding_percentage:.1,xgroup_padding_percentage:.25,xgroup_outer_padding_percentage:0,y_categorical_show_guides:!1,x_categorical_show_guide:!1,rotate_x_labels:0,rotate_y_labels:0,y_accessor:"value",y_label:"",yax_units:"",yax_units_append:!1,x_rug:!1,y_rug:!1,mouseover_align:"right",x_mouseover:null,y_mouseover:null,transition_on_update:!0,mouseover:null,click:null,show_rollover_text:!0,show_confidence_band:null,xax_format:null,area:!0,chart_type:"line",data:[],decimals:2,format:"count",inflator:10/9,linked:!1,linked_format:"%Y-%m-%d",list:!1,baselines:null,markers:null,scalefns:{},scales:{},utc_time:!1,european_clock:!1,show_year_markers:!1,show_secondary_x_label:!0,target:"#viz",interpolate:a.curveCatmullRom.alpha(0),custom_line_color_map:[],colors:null,max_data_size:null,aggregate_rollover:!1,show_tooltips:!0};MG.call_hook("global.defaults",c),b||(b={});var d=MG.charts[b.chart_type||c.chart_type];P(b,d.defaults,c),b.list&&(b.x_accessor=0,b.y_accessor=1);for(var e in MG.deprecations)if(b.hasOwnProperty(e)){var f=MG.deprecations[e],g="Use of `args."+e+"` has been deprecated",h=f.replacement;if(h&&(b[h]?g+=". The replacement - `args."+h+"` - has already been defined. This definition will be discarded.":b[h]=b[e]),f.warned)continue;f.warned=!0,h&&(g+=" in favor of `args."+h+"`"),V(g,f.version)}return MG.call_hook("global.before_init",b),new d.descriptor(b),b.data},b()&&(+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data("bs.tooltip",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",a,b)};c.VERSION="3.3.5",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},c.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusin"==b.type?"focus":"hover"]=!0),c.tip().hasClass("in")||"in"==c.hoverState?void(c.hoverState="in"):(clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusout"==b.type?"focus":"hover"]=!1),c.isInStateTrue()?void 0:(clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide())},c.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr("id",g),this.$element.attr("aria-describedby",g),this.options.animation&&f.addClass("fade");var h="function"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,j=i.test(h);j&&(h=h.replace(i,"")||"top"),f.detach().css({top:0,left:0,display:"block"}).addClass(h).data("bs."+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.getPosition(this.$viewport);h="bottom"==h&&k.bottom+m>o.bottom?"top":"top"==h&&k.top-m<o.top?"bottom":"right"==h&&k.right+l>o.width?"left":"left"==h&&k.left-l<o.left?"right":h,f.removeClass(n).addClass(h)}var p=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(p,h);var q=function(){var a=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",q).emulateTransitionEnd(c.TRANSITION_DURATION):q()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},c.prototype.hide=function(b){function d(){"in"!=e.hoverState&&f.detach(),e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),b&&b()}var e=this,f=a(this.$tip),g=a.Event("hide.bs."+this.type);return this.$element.trigger(g),g.isDefaultPrevented()?void 0:(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this)},c.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=d?{top:0,left:0}:b.offset(),g={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},h=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,g,h,f)},c.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.right&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},c.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass("in")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null})};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw Error("Popover requires tooltip.js");c.VERSION="3.3.5",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery)),MG.chart_title=Z,MG.scale_factory=ba;var Oc={};Oc.categorical=function(a,b){b.namespace,va(a,b),wa(a,b)},Oc.numerical=function(a,b){var c=b.namespace,d=c+"_axis",e="mg-"+c+"-axis",f=H(a.target);if(w(f,"."+e),!a[d])return this;var g=x(f,e);return ga(a,c),ra(g,a,b),qa(g,a,b),pa(g,a,b),a[c+"_label"]&&b.label(f.select(".mg-"+c+"-axis"),a),a[c+"_rug"]&&ta(a,b),a.show_bar_zero&&Ba(a),this},MG.axis_factory=ya,MG.y_rug=za,MG.y_axis=Ga,MG.y_axis_categorical=Ma,MG.x_rug=Na,MG.x_axis=Pa,MG.x_axis_categorical=Qa,MG.init=Ib,MG.markers=Wb;var Pc=new bc;b()&&+function(a){"use strict";function b(b){b&&3===b.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=c(d),f={relatedTarget:this};e.hasClass("open")&&(e.trigger(b=a.Event("hide.bs.dropdown",f)),b.isDefaultPrevented()||(d.attr("aria-expanded","false"),e.removeClass("open").trigger("hidden.bs.dropdown",f)))}))}function c(b){var c=b.attr("data-target");c||(c=b.attr("href"),
c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})}if("function"==typeof a().dropdown)return!0;var e=".dropdown-backdrop",f='[data-toggle="dropdown"]',g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.3.1",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=c(e),g=f.hasClass("open");if(b(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",b);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),f.toggleClass("open").trigger("shown.bs.dropdown",h)}return!1}},g.prototype.keydown=function(b){if(/(38|40|27|32)/.test(b.which)&&!/input|textarea/i.test(b.target.tagName)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var e=c(d),g=e.hasClass("open");if(!g&&27!=b.which||g&&27==b.which)return 27==b.which&&e.find(f).trigger("focus"),d.trigger("click");var h=" li:not(.divider):visible a",i=e.find('[role="menu"]'+h+', [role="listbox"]'+h);if(i.length){var j=i.index(b.target);38==b.which&&j>0&&j--,40==b.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",b).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f,g.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',g.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',g.prototype.keydown)}(jQuery),MG.button_layout=function(a){"use strict";return this.target=a,this.feature_set={},this.public_name={},this.sorters={},this.manual=[],this.manual_map={},this.manual_callback={},this._strip_punctuation=function(a){var b=a.replace(/[^a-zA-Z0-9 _]+/g,""),c=b.replace(/ +?/g,"");return c},this.data=function(a){return this._data=a,this},this.manual_button=function(a,b,c){return this.feature_set[a]=b,this.manual_map[this._strip_punctuation(a)]=a,this.manual_callback[a]=c,this},this.button=function(a){return arguments.length>1&&(this.public_name[a]=arguments[1]),arguments.length>2&&(this.sorters[a]=arguments[2]),this.feature_set[a]=[],this},this.callback=function(a){return this._callback=a,this},this.display=function(){var a,b,c,d,e=this._callback,f=this.manual_callback,g=this.manual_map;c=Object.keys(this.feature_set);var h,i=function(b){return a[b]};for(h=0;h<this._data.length;h++){a=this._data[h],b=c.map(i);for(var j=0;j<c.length;j++)d=c[j],-1===this.feature_set[d].indexOf(b[j])&&this.feature_set[d].push(b[j])}for(d in this.feature_set)this.sorters.hasOwnProperty(d)&&this.feature_set[d].sort(this.sorters[d]);$(this.target).empty(),$(this.target).append("<div class='col-lg-12 segments text-center'></div>");var k=function(){var a,b=$(this).data("key"),c=$(this).data("feature");return $("."+c+"-btns button.btn span.title").html(b),g.hasOwnProperty(c)?(a=g[c],f[a](b)):e(c,b),!1};for(var l in this.feature_set){for(c=this.feature_set[l],$(this.target+" div.segments").append('<div class="btn-group '+this._strip_punctuation(l)+'-btns text-left"><button type="button" class="btn btn-default btn-lg dropdown-toggle" data-toggle="dropdown"><span class=\'which-button\'>'+(this.public_name.hasOwnProperty(l)?this.public_name[l]:l)+"</span><span class='title'>"+(this.manual_callback.hasOwnProperty(l)?this.feature_set[l][0]:"all")+'</span><span class="caret"></span></button><ul class="dropdown-menu" role="menu">'+(this.manual_callback.hasOwnProperty(l)?"":'<li><a href="#" data-feature="'+l+'" data-key="all">All</a></li>')+(this.manual_callback.hasOwnProperty(l)?"":'<li class="divider"></li>')+"</ul></div>"),h=0;h<c.length;h++)"all"!==c[h]&&void 0!==c[h]&&$(this.target+" div."+this._strip_punctuation(l)+"-btns ul.dropdown-menu").append('<li><a href="#" data-feature="'+this._strip_punctuation(l)+'" data-key="'+c[h]+'">'+c[h]+"</a></li>");$("."+this._strip_punctuation(l)+"-btns .dropdown-menu li a").on("click",k)}return this},this},function(){"use strict";function b(a,b,c){a.classed("mg-hover-line"+b.line_id+"-color",null===c.colors).attr("fill",null===c.colors?"":c.colors[b.line_id-1])}function g(a,b,c){k(a,b),i(a,b),j(a,b),h(a,b,c)}function h(b,c,d){c.existing_band=d.selectAll(".mg-confidence-band").nodes(),b.show_confidence_band&&(c.confidence_area=a.area().defined(c.line.defined()).x(b.scalefns.xf).y0(function(a){var c=b.show_confidence_band[0];return b.scales.Y(void 0!=a[c]?a[c]:a[b.y_accessor])}).y1(function(a){var c=b.show_confidence_band[1];return b.scales.Y(void 0!=a[c]?a[c]:a[b.y_accessor])}).curve(b.interpolate))}function i(b,c){c.area=a.area().defined(c.line.defined()).x(b.scalefns.xf).y0(b.scales.Y.range()[0]).y1(b.scalefns.yf).curve(b.interpolate)}function j(b,c){c.flat_line=a.line().defined(function(a){return(void 0===a._missing||a._missing!==!0)&&null!==a[b.y_accessor]}).x(b.scalefns.xf).y(function(){return b.scales.Y(c.data_median)}).curve(b.interpolate)}function k(b,c){c.line=a.line().x(b.scalefns.xf).y(b.scalefns.yf).curve(b.interpolate),b.missing_is_zero||(c.line=c.line.defined(function(a){return(void 0===a._missing||a._missing!==!0)&&null!==a[b.y_accessor]}))}function l(a,b,c,d){if(a.show_confidence_band){var e;c.select(".mg-confidence-band-"+d).empty()&&c.append("path").attr("class","mg-confidence-band mg-confidence-band-"+d),e=c.select(".mg-confidence-band-"+d),e.transition().duration(function(){return a.transition_on_update?1e3:0}).attr("d",b.confidence_area(a.data[d-1])).attr("clip-path","url(#mg-plot-window-"+K(a.target)+")")}}function m(a,b,c,d,e){var f=c.selectAll(".mg-main-area.mg-area"+e);b.display_area?f.empty()?c.append("path").classed("mg-main-area",!0).classed("mg-area"+e,!0).classed("mg-area"+e+"-color",null===a.colors).attr("d",b.area(a.data[d])).attr("fill",null===a.colors?"":a.colors[e-1]).attr("clip-path","url(#mg-plot-window-"+K(a.target)+")"):(c.node().appendChild(f.node()),f.transition().duration(b.update_transition_duration).attr("d",b.area(a.data[d])).attr("clip-path","url(#mg-plot-window-"+K(a.target)+")")):f.empty()||f.remove()}function n(a,b){a.classed("mg-line"+b+"-color",!0)}function o(a,b,c,d){a.colors&&a.colors.constructor===Array?(b.attr("stroke",a.colors[c]),a.colors.length<c+1&&n(b,d)):n(b,d)}function p(b,c,d,e){b.animate_on_load?(c.data_median=a.median(b.data[e],function(a){return a[b.y_accessor]}),d.attr("d",c.flat_line(b.data[e])).transition().duration(2e3).attr("d",c.line(b.data[e])).attr("clip-path","url(#mg-plot-window-"+K(b.target)+")")):d.attr("d",c.line(b.data[e])).attr("clip-path","url(#mg-plot-window-"+K(b.target)+")")}function q(a,b,c,d,e,f){if(d.empty()){var g=c.append("path").attr("class","mg-main-line mg-line"+f);o(a,g,e,f),p(a,b,g,e)}else{c.node().appendChild(d.node());var h=d.transition().duration(b.update_transition_duration);b.display_area||!a.transition_on_update||a.missing_is_hidden?h.attr("d",b.line(a.data[e])):h.attrTween("d",Gc(b.line(a.data[e]),4))}}function r(a,b,c,d){var g;if(a.legend)if(e(a.legend)?g=a.legend[c]:f(a.legend)&&(g=a.legend(a.data[c])),a.legend_target)b.legend_text=a.colors&&a.colors.constructor===Array?"<span style='color:"+a.colors[c]+"'>&mdash; "+g+"&nbsp; </span>"+b.legend_text:"<span class='mg-line"+d+"-legend-color'>&mdash; "+g+"&nbsp; </span>"+b.legend_text;else{var h,i,j;"left"===a.y_axis_position?(h=a.data[c][a.data[c].length-1],i="start",j=a.buffer):(h=a.data[c][0],i="end",j=-a.buffer);var k=b.legend_group.append("svg:text").attr("x",a.scalefns.xf(h)).attr("dx",j).attr("y",a.scalefns.yf(h)).attr("dy",".35em").attr("font-size",10).attr("text-anchor",i).attr("font-weight","300").text(g);a.colors&&a.colors.constructor===Array?a.colors.length<c+1?k.classed("mg-line"+d+"-legend-color",!0):k.attr("fill",a.colors[c]):k.classed("mg-line"+d+"-legend-color",!0),D(b.legend_group.selectAll(".mg-line-legend text").nodes(),a)}}function t(b,c){b&&a.select(b).html(c)}function v(a,b,c){a.legend&&(b.legend_group=x(c,"mg-line-legend"))}function y(a){w(a,".mg-rollover-rect"),w(a,".mg-voronoi"),w(a,".mg-active-datapoint"),w(a,".mg-line-rollover-circle")}function z(a,b){var c=b.selectAll(".mg-line-rollover-circle").data(a.data).enter().append("circle").attr("cx",0).attr("cy",100).attr("r",0);a.colors&&a.colors.constructor===Array?c.attr("class",function(a){return"mg-line"+a.line_id}).attr("fill",function(b,c){return a.colors[c]}).attr("stroke",function(b,c){return a.colors[c]}):c.attr("class",function(a){return["mg-line"+a.line_id,"mg-line"+a.line_id+"-color","mg-area"+a.line_id+"-color"].join(" ")}),c.classed("mg-line-rollover-circle",!0)}function A(a){for(var b=1,c=0;c<a.data.length;c++){for(var d=0;d<a.data[c].length;d++)a.data[c][d].line_id=a.custom_line_color_map.length>0?a.custom_line_color_map[c]:b;b++}}function B(b){return a.merge(b.data)}function C(a){return function(b){var c;if(a.linked){var d=b[a.x_accessor],e=MG.time_format(a.utc_time,a.linked_format),f="number"==typeof d?b.line_id-1:e(d);return c="roll_"+f+" mg-line"+b.line_id,null===a.color&&(c+=" mg-line"+b.line_id+"-color"),c}return c="mg-line"+b.line_id,null===a.color&&(c+=" mg-line"+b.line_id+"-color"),c}}function E(b,c,d,e,f){var g=a.voronoi().x(function(a){return b.scales.X(a[b.x_accessor]).toFixed(2)}).y(function(a){return b.scales.Y(a[b.y_accessor]).toFixed(2)}).extent([[b.buffer,b.buffer+b.title_y_position],[b.width-b.buffer,b.height-b.buffer]]),h=x(c,"mg-voronoi");h.selectAll("path").data(g.polygons(B(b))).enter().append("path").filter(function(a){return void 0!==a&&a.length>0}).attr("d",function(a){return null==a?null:"M"+a.join("L")+"Z"}).datum(function(a){return null==a?null:a.data}).attr("class",C(b)).on("mouseover",d).on("mouseout",e).on("mousemove",f),J(b,c)}function F(b){var c=a.nest().key(function(a){return a[b.x_accessor]}).entries(a.merge(b.data));return c.forEach(function(a){var c=a.values[0];a.key=c[b.x_accessor]}),b.x_sort?c.sort(function(a,b){return new Date(a.key)-new Date(b.key)}):c}function G(a,b,c,d,e){var f=F(a),g=f.map(function(b){return a.scales.X(b.key)}),h=b.append("g").attr("class","mg-rollover-rect");h.selectAll(".mg-rollover-rects").data(f).enter().append("rect").attr("x",function(b,c){return 1===g.length?s(a):0===c?g[c].toFixed(2):((g[c-1]+g[c])/2).toFixed(2)}).attr("y",a.top).attr("width",function(b,c){return 1===g.length?u(a):0===c?((g[c+1]-g[c])/2).toFixed(2):c===g.length-1?((g[c]-g[c-1])/2).toFixed(2):((g[c+1]-g[c-1])/2).toFixed(2)}).attr("class",function(b){var c=b.values.map(function(b){var c=L(b.line_id);return null===a.colors&&(c+=" "+M(b.line_id)),c}).join(" ");return a.linked&&b.values.length>0&&(c+=" "+N(O(b.values[0],0,a))),c}).attr("height",a.height-a.bottom-a.top-a.buffer).attr("opacity",0).on("mouseover",c).on("mouseout",d).on("mousemove",e),Q(a,b)}function I(a,b){b.select(".mg-rollover-rect rect").on("mouseover")(a.data[0][0],0)}function J(a,b){for(var c=0;c<a.data.length;c++){var d=c+1;a.custom_line_color_map.length>0&&void 0!==a.custom_line_color_map[c]&&(d=a.custom_line_color_map[c]),1!==a.data[c].length||b.selectAll(".mg-voronoi .mg-line"+d).empty()||(b.selectAll(".mg-voronoi .mg-line"+d).on("mouseover")(a.data[c][0],0),b.selectAll(".mg-voronoi .mg-line"+d).on("mouseout")(a.data[c][0],0))}}function L(a){return"mg-line"+a}function M(a){return"mg-line"+a+"-color"}function N(a){return"roll_"+a}function O(a,b,c){var d=a[c.x_accessor],e=MG.time_format(c.utc_time,c.linked_format),f="number"==typeof d?b:e(d);return f}function P(a,b,c,d,e){var f=1;a.custom_line_color_map.length>0&&(f=a.custom_line_color_map[0]);var g=b.append("g").attr("class","mg-rollover-rect"),h=a.data[0].map(a.scalefns.xf);g.selectAll(".mg-rollover-rects").data(a.data[0]).enter().append("rect").attr("class",function(b,c){var d=M(f)+" "+L(b.line_id);return a.linked&&(d+=d+" "+N(O(b,c,a))),d}).attr("x",function(b,c){return 1===h.length?s(a):0===c?h[c].toFixed(2):((h[c-1]+h[c])/2).toFixed(2)}).attr("y",function(b){return a.data.length>1?a.scalefns.yf(b)-6:a.top}).attr("width",function(b,c){return 1===h.length?u(a):0===c?((h[c+1]-h[c])/2).toFixed(2):c===h.length-1?((h[c]-h[c-1])/2).toFixed(2):((h[c+1]-h[c-1])/2).toFixed(2)}).attr("height",function(){return a.data.length>1?12:a.height-a.bottom-a.top-a.buffer}).attr("opacity",0).on("mouseover",c).on("mouseout",d).on("mousemove",e),T(a)&&I(a,b)}function Q(a,b){var c=b.selectAll(".mg-rollover-rect rect"),d=c.nodes()[0][0]||c.nodes()[0];a.data.filter(function(a){return 1===a.length}).length>0&&c.on("mouseover")(d.__data__,0)}function R(a){return a.data.length>1&&!a.aggregate_rollover}function S(a){return a.data.length>1&&a.aggregate_rollover}function T(a){return 1===a.data.length&&1===a.data[0].length}function U(a,b,c){V(b,c);for(var d=a.data.length-1;d>=0;d--){var e=a.data[d];MG.call_hook("line.before_each_series",[e,a]);var f=d+1;if(a.custom_line_color_map.length>0&&(f=a.custom_line_color_map[d]),a.data[d].line_id=f,0!==e.length){var g=c.select("path.mg-main-line.mg-line"+f);l(a,b,c,f),m(a,b,c,d,f),q(a,b,c,g,d,f),r(a,b,d,f),MG.call_hook("line.after_each_series",[e,g,a])}}}function V(a,b){a.existing_band[0]&&a.existing_band[0].length>b.selectAll(".mg-main-line").node().length&&b.selectAll(".mg-confidence-band").remove()}function W(a){var b={},c=H(a.target);w(c,".mg-line-legend"),v(a,b,c),b.data_median=0,b.update_transition_duration=a.transition_on_update?1e3:0,b.display_area=a.area&&!a.use_data_y_min&&a.data.length<=1&&a.aggregate_rollover===!1,b.legend_text="",g(a,b,c),b.existing_band=c.selectAll(".mg-confidence-band").nodes();var d=MG.call_hook("line.before_all_series",[a]);d!==!1&&U(a,b,c),t(a.legend_target,b.legend_text)}function X(a,b){var c=H(a.target);0===c.selectAll(".mg-active-datapoint-container").nodes().length&&x(c,"mg-active-datapoint-container"),y(c),z(a,c),A(a),R(a)?E(a,c,b.rolloverOn(a),b.rolloverOff(a),b.rolloverMove(a)):S(a)?G(a,c,b.rolloverOn(a),b.rolloverOff(a),b.rolloverMove(a)):P(a,c,b.rolloverOn(a),b.rolloverOff(a),b.rolloverMove(a))}function Y(a,b,c){if(a.aggregate_rollover&&a.data.length>1)b.selectAll("circle.mg-line-rollover-circle").style("opacity",0),c.values.forEach(function(c){d(c,a)&&Z(a,b,c)});else{if(a.missing_is_hidden&&c._missing||null===c[a.y_accessor])return;d(c,a)&&$(a,b,c)}}function Z(a,b,c){b.select("circle.mg-line-rollover-circle.mg-line"+c.line_id).attr("cx",a.scales.X(c[a.x_accessor]).toFixed(2)).attr("cy",a.scales.Y(c[a.y_accessor]).toFixed(2)).attr("r",a.point_size).style("opacity",1)}function $(a,b,c){b.selectAll("circle.mg-line-rollover-circle.mg-line"+c.line_id).classed("mg-line-rollover-circle",!0).style("opacity",1).transition().duration(100).attr("cx",function(){return a.scales.X(c[a.x_accessor]).toFixed(2)}).attr("cy",function(){return a.scales.Y(c[a.y_accessor]).toFixed(2)}).attr("r",a.point_size)}function _(b,c,d){if(console.log("moved"),b.linked&&!MG.globals.link&&(MG.globals.link=!0,!b.aggregate_rollover||void 0!==c.value||c.values.length>0)){var e=c.values?c.values[0]:c,f=O(e,d,b);a.selectAll("."+L(e.line_id)+"."+N(f)).each(function(b){a.select(this).on("mouseover")(b,d)})}}function aa(b,c,d){if(b.linked&&MG.globals.link){MG.globals.link=!1;var e=MG.time_format(b.utc_time,b.linked_format),f=c.values?c.values:[c];f.forEach(function(c){var f=c[b.x_accessor],g="number"==typeof f?d:e(f);a.selectAll(".roll_"+g).each(function(b){a.select(this).on("mouseout")(b)})})}}function ba(a,b){b.selectAll("circle.mg-line-rollover-circle").filter(function(a){return a.length>1}).style("opacity",0)}function ca(a,b,c){b.selectAll("circle.mg-line-rollover-circle.mg-line"+c.line_id).style("opacity",function(){var b=c.line_id-1;return a.custom_line_color_map.length>0&&void 0!==a.custom_line_color_map.indexOf(c.line_id)&&(b=a.custom_line_color_map.indexOf(c.line_id)),1===a.data[b].length?1:0})}function da(a){this.init=function(a){if(this.args=a,!a.data||0===a.data.length)return a.internal_error="No data was supplied",Mc(a),this;a.internal_error=void 0,hc(a),lc(a),MG.call_hook("line.before_destroy",this),Ib(a),new MG.scale_factory(a).namespace("x").numericalDomainFromData().numericalRange("bottom");var b=(a.baselines||[]).map(function(b){return b[a.y_accessor]});return new MG.scale_factory(a).namespace("y").zeroBottom(!0).inflateDomain(!0).numericalDomainFromData(b).numericalRange("left"),H(a.target),a.x_axis&&new MG.axis_factory(a).namespace("x").type("numerical").position(a.x_axis_position).rug(Na(a)).label(Ta).draw(),a.y_axis&&new MG.axis_factory(a).namespace("y").type("numerical").position(a.y_axis_position).rug(za(a)).label(Ca).draw(),this.markers(),this.mainPlot(),this.rollover(),this.windowListeners(),MG.call_hook("line.after_init",this),this},this.mainPlot=function(){return W(a),this},this.markers=function(){return Wb(a),this},this.rollover=function(){var b=this;return X(a,b),MG.call_hook("line.after_rollover",a),this},this.rolloverOn=function(a){var d=H(a.target);return c(a),function(c,e){if(Y(a,d,c),_(a,c,e),d.selectAll("text").filter(function(a){return c===a}).attr("opacity",.3),a.show_rollover_text&&!(a.missing_is_hidden&&c._missing||null===c[a.y_accessor])){var f=ac(a,{svg:d}),g=f.mouseover_row();a.aggregate_rollover&&g.text((a.aggregate_rollover&&a.data.length>1?Fc:Dc)(a,c));var h=a.aggregate_rollover&&a.data.length>1?c.values:[c];h.forEach(function(c){a.aggregate_rollover&&(g=f.mouseover_row()),a.legend&&b(g.text(a.legend[c.line_id-1]+"  ").bold().elem(),c,a),b(g.text("—  ").elem(),c,a),a.aggregate_rollover||g.text(Dc(a,c)),g.text(Ec(a,c,a.time_series===!1))})}a.mouseover&&a.mouseover(c,e)}},this.rolloverOff=function(a){var b=H(a.target);return function(c,d){aa(a,c,d),a.aggregate_rollover?ba(a,b):ca(a,b,c),a.data[0].length>1&&Xb(b),a.mouseout&&a.mouseout(c,d)}},this.rolloverMove=function(a){return function(b,c){a.mousemove&&a.mousemove(b,c)}},this.windowListeners=function(){return cc(this.args),this},this.init(a)}MG.register("line",da)}.call(this),function(){"use strict";function b(b){this.init=function(a){this.args=a,hc(a),mc(a),Ib(a),new MG.scale_factory(a).namespace("x").numericalDomainFromData().numericalRange("bottom");var b=(a.baselines||[]).map(function(b){return b[a.y_accessor]});return new MG.scale_factory(a).namespace("y").zeroBottom(!0).inflateDomain(!0).numericalDomainFromData(b).numericalRange("left"),Pa(a),Ga(a),this.mainPlot(),this.markers(),this.rollover(),this.windowListeners(),this},this.mainPlot=function(){var a=H(b.target);a.selectAll(".mg-histogram").remove();var c=a.append("g").attr("class","mg-histogram"),d=c.selectAll(".mg-bar").data(b.data[0]).enter().append("g").attr("class","mg-bar").attr("transform",function(a){return"translate("+b.scales.X(a[b.x_accessor]).toFixed(2)+","+b.scales.Y(a[b.y_accessor]).toFixed(2)+")"});return d.append("rect").attr("x",1).attr("width",function(a,c){return 1===b.data[0].length?(b.scalefns.xf(b.data[0][0])-b.bar_margin).toFixed(0):c!==b.data[0].length-1?(b.scalefns.xf(b.data[0][c+1])-b.scalefns.xf(a)).toFixed(0):(b.scalefns.xf(b.data[0][1])-b.scalefns.xf(b.data[0][0])).toFixed(0)}).attr("height",function(a){return 0===a[b.y_accessor]?0:(b.height-b.bottom-b.buffer-b.scales.Y(a[b.y_accessor])).toFixed(2)}),this},this.markers=function(){return Wb(b),this},this.rollover=function(){var a=H(b.target);0===a.selectAll(".mg-active-datapoint-container").nodes().length&&x(a,"mg-active-datapoint-container"),a.selectAll(".mg-rollover-rect").remove(),a.selectAll(".mg-active-datapoint").remove();var c=a.append("g").attr("class","mg-rollover-rect"),d=c.selectAll(".mg-bar").data(b.data[0]).enter().append("g").attr("class",function(a,c){return b.linked?"mg-rollover-rects roll_"+c:"mg-rollover-rects"}).attr("transform",function(a){return"translate("+b.scales.X(a[b.x_accessor])+",0)"});return d.append("rect").attr("x",1).attr("y",b.buffer+b.title_y_position).attr("width",function(a,c){return 1===b.data[0].length?(b.scalefns.xf(b.data[0][0])-b.bar_margin).toFixed(0):c!==b.data[0].length-1?(b.scalefns.xf(b.data[0][c+1])-b.scalefns.xf(a)).toFixed(0):(b.scalefns.xf(b.data[0][1])-b.scalefns.xf(b.data[0][0])).toFixed(0)}).attr("height",function(){return b.height}).attr("opacity",0).on("mouseover",this.rolloverOn(b)).on("mouseout",this.rolloverOff(b)).on("mousemove",this.rolloverMove(b)),this},this.rolloverOn=function(b){var c=H(b.target);return function(d,e){if(c.selectAll("text").filter(function(a){return d===a}).attr("opacity",.3),b.processed.xax_format||MG.time_format(b.utc_time,"%b %e, %Y"),Bc(b),c.selectAll(".mg-bar rect").filter(function(a,b){return b===e}).classed("active",!0),b.linked&&!MG.globals.link&&(MG.globals.link=!0,a.selectAll(".mg-rollover-rects.roll_"+e+" rect").each(function(b){a.select(this).on("mouseover")(b,e)})),b.show_rollover_text){var f=ac(b,{svg:c}),g=f.mouseover_row();g.text("▟  ").elem().classed("hist-symbol",!0),g.text(Dc(b,d)),g.text(Ec(b,d,b.time_series===!1))}b.mouseover&&(Yb(c,b),b.mouseover(d,e))}},this.rolloverOff=function(b){var c=H(b.target);return function(d,e){b.linked&&MG.globals.link&&(MG.globals.link=!1,a.selectAll(".mg-rollover-rects.roll_"+e+" rect").each(function(b){a.select(this).on("mouseout")(b,e)})),c.selectAll(".mg-bar rect").classed("active",!1),Xb(c),b.mouseout&&b.mouseout(d,e)}},this.rolloverMove=function(a){return function(b,c){a.mousemove&&a.mousemove(b,c)}},this.windowListeners=function(){return cc(this.args),this},this.init(b)}var c={binned:!1,bins:null,processed_x_accessor:"x",processed_y_accessor:"y",processed_dx_accessor:"dx",bar_margin:1};MG.register("histogram",b,c)}.call(this),function(){"use strict";function b(a,b){var c=b.x_accessor,d=b.y_accessor,e=a.filter(function(a){return!(null!==b.min_x&&a[c]<b.min_x||null!==b.max_x&&a[c]>b.max_x||null!==b.min_y&&a[d]<b.min_y||null!==b.max_y&&a[d]>b.max_y)});return e}function c(c){this.init=function(a){this.args=a,a.x_axis_type=G(a,"x"),a.y_axis_type=G(a,"y"),hc(a),oc(a),Ib(a);var b,c;if("categorical"===a.x_axis_type?(b=MG.scale_factory(a).namespace("x").categoricalDomainFromData().categoricalRangeBands([0,a.xgroup_height],null===a.xgroup_accessor),a.xgroup_accessor?new MG.scale_factory(a).namespace("xgroup").categoricalDomainFromData().categoricalRangeBands("bottom"):(a.scales.XGROUP=function(){return s(a)},a.scalefns.xgroupf=function(){return s(a)}),a.scalefns.xoutf=function(b){return a.scalefns.xf(b)+a.scalefns.xgroupf(b)}):(b=MG.scale_factory(a).namespace("x").inflateDomain(!0).zeroBottom("categorical"===a.y_axis_type).numericalDomainFromData((a.baselines||[]).map(function(b){return b[a.x_accessor]})).numericalRange("bottom"),a.scalefns.xoutf=a.scalefns.xf),"categorical"===a.y_axis_type)c=MG.scale_factory(a).namespace("y").zeroBottom(!0).categoricalDomainFromData().categoricalRangeBands([0,a.ygroup_height],!0),a.ygroup_accessor?new MG.scale_factory(a).namespace("ygroup").categoricalDomainFromData().categoricalRangeBands("left"):(a.scales.YGROUP=function(){return q(a)},a.scalefns.ygroupf=function(){return q(a)}),a.scalefns.youtf=function(b){return a.scalefns.yf(b)+a.scalefns.ygroupf(b)};else{var d=(a.baselines||[]).map(function(b){return b[a.y_accessor]});c=MG.scale_factory(a).namespace("y").inflateDomain(!0).zeroBottom("categorical"===a.x_axis_type).numericalDomainFromData(d).numericalRange("left"),a.scalefns.youtf=function(b){return a.scalefns.yf(b)}}if(null!==a.color_accessor){var e=MG.scale_factory(a).namespace("color");"number"===a.color_type?e.numericalDomainFromData(ea(a)).numericalRange(fa(a)).clamp(!0):a.color_domain?e.categoricalDomain(a.color_domain).categoricalRange(a.color_range):e.categoricalDomainFromData().categoricalColorRange()}return a.size_accessor&&new MG.scale_factory(a).namespace("size").numericalDomainFromData().numericalRange(Sa(a)).clamp(!0),new MG.axis_factory(a).namespace("x").type(a.x_axis_type).zeroLine("categorical"===a.y_axis_type).position(a.x_axis_position).rug(Na(a)).label(Ta).draw(),new MG.axis_factory(a).namespace("y").type(a.y_axis_type).zeroLine("categorical"===a.x_axis_type).position(a.y_axis_position).rug(za(a)).label(Ca).draw(),this.mainPlot(),this.markers(),this.rollover(),this.windowListeners(),this},this.markers=function(){return Wb(c),c.least_squares&&pc(c),this},this.mainPlot=function(){var a,d=H(c.target),e=b(c.data[0],c);d.selectAll(".mg-points").remove(),a=d.append("g").classed("mg-points",!0);var f=a.selectAll("circle").data(e).enter().append("circle").attr("class",function(a,b){return"path-"+b}).attr("cx",c.scalefns.xoutf).attr("cy",function(a){return c.scalefns.youtf(a)});return null!==c.color_accessor?(f.attr("fill",c.scalefns.colorf),f.attr("stroke",c.scalefns.colorf)):f.classed("mg-points-mono",!0),null!==c.size_accessor?f.attr("r",c.scalefns.sizef):f.attr("r",c.point_size),this},this.rollover=function(){var d=H(c.target);0===d.selectAll(".mg-active-datapoint-container").nodes().length&&x(d,"mg-active-datapoint-container"),d.selectAll(".mg-voronoi").remove();var e=a.voronoi().x(c.scalefns.xoutf).y(c.scalefns.youtf).extent([[c.buffer,c.buffer+c.title_y_position],[c.width-c.buffer,c.height-c.buffer]]),f=d.append("g").attr("class","mg-voronoi");return f.selectAll("path").data(e.polygons(b(c.data[0],c))).enter().append("path").attr("d",function(a){return null==a?null:"M"+a.join(",")+"Z"}).attr("class",function(a,b){return"path-"+b}).style("fill-opacity",0).on("mouseover",this.rolloverOn(c)).on("mouseout",this.rolloverOff(c)).on("mousemove",this.rolloverMove(c)),1===c.data[0].length&&ec(c,d,c.data[0][0]),this},this.rolloverOn=function(b){var c=H(b.target);return function(d,e){c.selectAll(".mg-points circle").classed("selected",!1);var f=c.selectAll(".mg-points circle.path-"+e).classed("selected",!0);b.size_accessor?f.attr("r",function(a){return b.scalefns.sizef(a)+b.active_point_size_increase}):f.attr("r",b.point_size+b.active_point_size_increase),b.linked&&!MG.globals.link&&(MG.globals.link=!0,a.selectAll(".mg-voronoi .path-"+e).each(function(){a.select(this).on("mouseover")(d,e)})),b.show_rollover_text&&ec(b,c,d.data),b.mouseover&&b.mouseover(d,e)}},this.rolloverOff=function(b){var c=H(b.target);return function(d,e){b.linked&&MG.globals.link&&(MG.globals.link=!1,a.selectAll(".mg-voronoi .path-"+e).each(function(){a.select(this).on("mouseout")(d,e)}));var f=c.selectAll(".mg-points circle").classed("unselected",!1).classed("selected",!1);b.size_accessor?f.attr("r",b.scalefns.sizef):f.attr("r",b.point_size),b.data[0].length>1&&Xb(c),b.mouseout&&b.mouseout(d,e)}},this.rolloverMove=function(a){return function(b,c){a.mousemove&&a.mousemove(b,c)}},this.update=function(){return this},this.windowListeners=function(){return cc(this.args),this},this.init(c)}var d={y_padding_percentage:.05,y_outer_padding_percentage:.2,ygroup_padding_percentage:0,ygroup_outer_padding_percentage:0,x_padding_percentage:.05,x_outer_padding_percentage:.2,xgroup_padding_percentage:0,xgroup_outer_padding_percentage:0,y_categorical_show_guides:!0,x_categorical_show_guides:!0,buffer:16,ls:!1,lowess:!1,point_size:2.5,label_accessor:null,size_accessor:null,color_accessor:null,size_range:null,color_range:null,size_domain:null,color_domain:null,active_point_size_increase:1,color_type:"number"};MG.register("point",c,d)}.call(this),function(){"use strict";function b(b){var c;if(b.legend_target){var d=a.select(b.legend_target).append("div").classed("mg-bar-target-legend",!0);c="horizontal"==b.orientation?b.scales.Y.domain():b.scales.X.domain(),c.forEach(function(a){var c=d.append("span").classed("mg-bar-target-element",!0);c.append("span").classed("mg-bar-target-legend-shape",!0).style("color",b.scales.COLOR(a)).text("◼ "),c.append("span").classed("mg-bar-target-legend-text",!0).text(a)})}}function c(a,b){var c;c="horizontal"==b.orientation?b.scales.Y.domain():b.scales.X.domain();var d=0,e=1.1,f=a.append("g").classed("mg-bar-legend",!0),g=f.append("text");g.selectAll("*").remove(),g.attr("width",b.right).attr("height",100).attr("text-anchor","start"),c.forEach(function(a){var c=g.append("tspan").attr("x",u(b)).attr("y",b.height/2).attr("dy",d*e+"em");c.append("tspan").text("■ ").attr("fill",b.scales.COLOR(a)).attr("font-size",20),c.append("tspan").text(a).attr("font-weight",300).attr("font-size",10),d++})}function d(d){this.args=d,this.init=function(a){this.args=a,a.x_axis_type=G(a,"x"),a.y_axis_type=G(a,"y"),"categorical"==a.x_axis_type?a.orientation="vertical":"categorical"==a.y_axis_type?a.orientation="horizontal":"categorical"!=a.x_axis_type&&"categorical"!=a.y_axis_type&&(a.orientation="vertical"),hc(a),oc(a),Ib(a);var b,c;if("categorical"===a.x_axis_type?(b=MG.scale_factory(a).namespace("x").categoricalDomainFromData().categoricalRangeBands([0,a.xgroup_height],null===a.xgroup_accessor),a.xgroup_accessor?new MG.scale_factory(a).namespace("xgroup").categoricalDomainFromData().categoricalRangeBands("bottom"):(a.scales.XGROUP=function(){return s(a)},a.scalefns.xgroupf=function(){return s(a)}),a.scalefns.xoutf=function(b){return a.scalefns.xf(b)+a.scalefns.xgroupf(b)}):(b=MG.scale_factory(a).namespace("x").inflateDomain(!0).zeroBottom("categorical"===a.y_axis_type).numericalDomainFromData((a.baselines||[]).map(function(b){return b[a.x_accessor]})).numericalRange("bottom"),a.scalefns.xoutf=a.scalefns.xf),"categorical"===a.y_axis_type)c=MG.scale_factory(a).namespace("y").zeroBottom(!0).categoricalDomainFromData().categoricalRangeBands([0,a.ygroup_height],!0),a.ygroup_accessor?new MG.scale_factory(a).namespace("ygroup").categoricalDomainFromData().categoricalRangeBands("left"):(a.scales.YGROUP=function(){return q(a)},a.scalefns.ygroupf=function(){return q(a)}),a.scalefns.youtf=function(b){return a.scalefns.yf(b)+a.scalefns.ygroupf(b)};else{var d=(a.baselines||[]).map(function(b){return b[a.y_accessor]});c=MG.scale_factory(a).namespace("y").inflateDomain(!0).zeroBottom("categorical"===a.x_axis_type).numericalDomainFromData(d).numericalRange("left"),a.scalefns.youtf=function(b){return a.scalefns.yf(b)}}return null!==a.ygroup_accessor&&(a.ycolor_accessor=a.y_accessor,MG.scale_factory(a).namespace("ycolor").scaleName("color").categoricalDomainFromData().categoricalColorRange()),null!==a.xgroup_accessor&&(a.xcolor_accessor=a.x_accessor,MG.scale_factory(a).namespace("xcolor").scaleName("color").categoricalDomainFromData().categoricalColorRange()),new MG.axis_factory(a).namespace("x").type(a.x_axis_type).zeroLine("categorical"===a.y_axis_type).position(a.x_axis_position).draw(),new MG.axis_factory(a).namespace("y").type(a.y_axis_type).zeroLine("categorical"===a.x_axis_type).position(a.y_axis_position).draw(),this.mainPlot(),this.markers(),this.rollover(),this.windowListeners(),this},this.mainPlot=function(){var a,e=H(d.target),f=d.data[0],g=e.select("g.mg-barplot"),h=g.empty(),i=h&&d.animate_on_load;i||d.transition_on_update,d.transition_duration||1e3,h&&(g=e.append("g").classed("mg-barplot",!0)),a=g.selectAll(".mg-bar").data(f).enter().append("rect").classed("mg-bar",!0).classed("default-bar",!d.scales.hasOwnProperty("COLOR"));var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;if("vertical"==d.orientation&&(j="height",k="width",l=d.y_axis_type,m=d.x_axis_type,n="y",o="x",p="categorical"==l?d.scalefns.youtf:d.scalefns.yf,q="categorical"==m?d.scalefns.xoutf:d.scalefns.xf,r=d.scales.Y,s=d.scales.X,t=d.y_accessor,u=d.x_accessor,v=function(a){var b;return b=p(a),a[t]<0&&(b=r(0)),b},w=function(a){return Math.abs(p(a)-r(0))},x=function(a){return Math.abs(r(a[d.reference_accessor])-r(0))},y=function(a){return r(a[d.reference_accessor])}),"horizontal"==d.orientation&&(j="width",k="height",l=d.x_axis_type,m=d.y_axis_type,n="x",o="y",p="categorical"==l?d.scalefns.xoutf:d.scalefns.xf,q="categorical"==m?d.scalefns.youtf:d.scalefns.yf,r=d.scales.X,s=d.scales.Y,t=d.x_accessor,u=d.y_accessor,v=function(){
var a;return a=r(0)},w=function(a){return Math.abs(p(a)-r(0))},x=function(a){return Math.abs(r(a[d.reference_accessor])-r(0))},y=function(){return r(0)}),a.attr(n,v),a.attr(o,function(a){var b;return"categorical"==m?b=q(a):(b=s(0),a[u]<0&&(b=q(a))),b-=d.bar_thickness/2}),d.scales.COLOR&&a.attr("fill",d.scalefns.colorf),a.attr(j,w).attr(k,function(){return d.bar_thickness}),null!==d.reference_accessor){var z=f.filter(function(a){return a.hasOwnProperty(d.reference_accessor)}),A=g.selectAll(".mg-categorical-reference").data(z).enter().append("rect");A.attr(n,y).attr(o,function(a){return q(a)-d.reference_thickness/2}).attr(j,x).attr(k,d.reference_thickness)}if(null!==d.comparison_accessor){var B=null;B=null===d.comparison_thickness?d.bar_thickness/2:d.comparison_thickness;var C=f.filter(function(a){return a.hasOwnProperty(d.comparison_accessor)}),D=g.selectAll(".mg-categorical-comparison").data(C).enter().append("line");D.attr(n+"1",function(a){return r(a[d.comparison_accessor])}).attr(n+"2",function(a){return r(a[d.comparison_accessor])}).attr(o+"1",function(a){return q(a)-B/2}).attr(o+"2",function(a){return q(a)+B/2}).attr("stroke","black").attr("stroke-width",d.comparison_width)}return(d.legend||null!==d.color_accessor&&d.ygroup_accessor!==d.color_accessor)&&(d.legend_target?b(d):c(e,d)),this},this.markers=function(){return Wb(d),this},this.rollover=function(){var a,b=H(d.target);0===b.selectAll(".mg-active-datapoint-container").nodes().length&&x(b,"mg-active-datapoint-container"),b.selectAll(".mg-rollover-rect").remove(),b.selectAll(".mg-active-datapoint").remove();var c,e,f,g,h,i,j,k,l,m,n,o,p,r;"vertical"==d.orientation&&(c="height",e="width",f=d.y_axis_type,g=d.x_axis_type,h="y",i="x",j="categorical"==f?d.scalefns.youtf:d.scalefns.yf,k="categorical"==g?d.scalefns.xoutf:d.scalefns.xf,l=d.scales.Y,m=d.scales.X,n=d.y_accessor,o=d.x_accessor,p=function(){return q(d)},r=function(){return d.height-d.top-d.bottom-2*d.buffer}),"horizontal"==d.orientation&&(c="width",e="height",f=d.x_axis_type,g=d.y_axis_type,h="x",i="y",j="categorical"==f?d.scalefns.xoutf:d.scalefns.xf,k="categorical"==g?d.scalefns.youtf:d.scalefns.yf,l=d.scales.X,m=d.scales.Y,n=d.x_accessor,o=d.y_accessor,p=function(){var a;return a=l(0)},r=function(){return d.width-d.left-d.right-2*d.buffer});var s,t;"right"===d.rollover_align?(s=d.width-d.right,t="end"):"left"===d.rollover_align?(s=d.left,t="start"):(s=(d.width-d.left-d.right)/2+d.left,t="middle"),b.append("text").attr("class","mg-active-datapoint").attr("xml:space","preserve").attr("x",s).attr("y",.75*d.top).attr("dy",".35em").attr("text-anchor",t),a=b.append("g").attr("class","mg-rollover-rect");var u=a.selectAll(".mg-bar-rollover").data(d.data[0]).enter().append("rect").attr("class","mg-bar-rollover");return u.attr("opacity",0).attr(h,p).attr(i,function(a){var b;return"categorical"==g?b=k(a):(b=m(0),a[o]<0&&(b=k(a))),b-=d.bar_thickness/2}),u.attr(c,r),u.attr(e,function(){return d.bar_thickness}),u.on("mouseover",this.rolloverOn(d)).on("mouseout",this.rolloverOff(d)).on("mousemove",this.rolloverMove(d)),this},this.rolloverOn=function(b){var c=H(b.target);return this.is_vertical?b.x_accessor:b.y_accessor,this.is_vertical?b.y_accessor:b.x_accessor,this.is_vertical?b.yax_units:b.xax_units,function(d,e){var f=(MG.time_format(b.utc_time,"%b %e, %Y"),Bc(b),c.selectAll("g.mg-barplot .mg-bar").filter(function(a,b){return b===e}).classed("active",!0));if(b.scales.hasOwnProperty("COLOR")?f.attr("fill",a.rgb(b.scalefns.colorf(d)).darker()):f.classed("default-active",!0),b.show_rollover_text){var g=ac(b,{svg:c}),h=g.mouseover_row();b.ygroup_accessor&&h.text(d[b.ygroup_accessor]+"   ").bold(),h.text(Dc(b,d)),h.text(b.y_accessor+": "+d[b.y_accessor]),(b.predictor_accessor||b.baseline_accessor)&&(h=g.mouseover_row(),b.predictor_accessor&&h.text(Cc(b,d,null,b.predictor_accessor,!1)),b.baseline_accessor&&h.text(Cc(b,d,null,b.baseline_accessor,!1)))}b.mouseover&&b.mouseover(d,e)}},this.rolloverOff=function(a){var b=H(a.target);return function(c,d){var e=b.selectAll("g.mg-barplot .mg-bar.active").classed("active",!1);a.scales.hasOwnProperty("COLOR")?e.attr("fill",a.scalefns.colorf(c)):e.classed("default-active",!1),b.select(".mg-active-datapoint").text(""),Xb(b),a.mouseout&&a.mouseout(c,d)}},this.rolloverMove=function(a){return function(b,c){a.mousemove&&a.mousemove(b,c)}},this.windowListeners=function(){return cc(this.args),this},this.init(d)}var e={y_padding_percentage:.05,y_outer_padding_percentage:.2,ygroup_padding_percentage:0,ygroup_outer_padding_percentage:0,x_padding_percentage:.05,x_outer_padding_percentage:.2,xgroup_padding_percentage:0,xgroup_outer_padding_percentage:0,buffer:16,y_accessor:"factor",x_accessor:"value",reference_accessor:null,comparison_accessor:null,secondary_label_accessor:null,color_accessor:null,color_type:"category",color_domain:null,reference_thickness:1,comparison_width:3,comparison_thickness:null,legend:!1,legend_target:null,mouseover_align:"right",baseline_accessor:null,predictor_accessor:null,predictor_proportion:5,show_bar_zero:!0,binned:!0,truncate_x_labels:!0,truncate_y_labels:!0};MG.register("bar",d,e)}.call(this),MG.data_table=function(c){"use strict";return this.args=c,this.args.standard_col={width:150,font_size:12,font_weight:"normal"},this.args.columns=[],this.formatting_options=[["color","color"],["font-weight","font_weight"],["font-style","font_style"],["font-size","font_size"]],this._strip_punctuation=function(a){var b=a.replace(/[^a-zA-Z0-9 _]+/g,""),c=b.replace(/ +?/g,"");return c},this._format_element=function(a,b,c){this.formatting_options.forEach(function(d){var e=d[0],f=d[1];c[f]&&a.style(e,"string"==typeof c[f]||"number"==typeof c[f]?c[f]:c[f](b))})},this._add_column=function(a,b){var c=this.args.standard_col,d=P(MG.clone(a),MG.clone(c));d.type=b,this.args.columns.push(d)},this.target=function(){var a=arguments[0];return this.args.target=a,this},this.title=function(){return this._add_column(arguments[0],"title"),this},this.text=function(){return this._add_column(arguments[0],"text"),this},this.bullet=function(){return this},this.sparkline=function(){return this},this.number=function(){return this._add_column(arguments[0],"number"),this},this.display=function(){var c=this.args;Z(c);var d,e,f,g,h,i,j,k,l,m,n,o,p=c.target,q=a.select(p).append("table").classed("mg-data-table",!0),r=q.append("colgroup"),s=q.append("thead"),t=q.append("tbody");for(f=s.append("tr"),o=0;o<c.columns.length;o++){var u=c.columns[o];i=u.type,k=u.label,k=void 0===k?"":k,g=f.append("th").style("width",u.width).style("text-align","title"===i?"left":"right").text(k),c.show_tooltips&&u.description&&b()&&(g.append("i").classed("fa",!0).classed("fa-question-circle",!0).classed("fa-inverse",!0),$(g.node()).popover({html:!0,animation:!1,content:u.description,trigger:"hover",placement:"top",container:$(g.node())}))}for(o=0;o<c.columns.length;o++)n=r.append("col"),"number"===c.columns[o].type&&n.attr("align","char").attr("char",".");for(var v=0;v<c.data.length;v++){f=t.append("tr");for(var w=0;w<c.columns.length;w++){if(d=c.columns[w],h=d.accessor,j=l=c.data[v][h],i=d.type,"number"===i){if(d.hasOwnProperty("round")&&!d.hasOwnProperty("format")&&(l=a.format("0,."+d.round+"f")(l)),d.hasOwnProperty("value_formatter")&&(l=d.value_formatter(l)),d.hasOwnProperty("format")){d.round&&(l=Math.round(l,d.round));var x,y=d.format;"percentage"===y&&(x=a.format(".0%")),"count"===y&&(x=a.format(",.0f")),"temperature"===y&&(x=function(a){return a+"°"}),l=x(l)}d.hasOwnProperty("currency")&&(l=d.currency+l)}m=f.append("td").classed("table-"+i,!0).classed("table-"+i+"-"+this._strip_punctuation(h),!0).attr("data-value",j).style("width",d.width).style("text-align","title"===i||"text"===i?"left":"right"),this._format_element(m,j,d),"title"===i?(e=m.append("div").text(l),this._format_element(e,l,d),c.columns[w].hasOwnProperty("secondary_accessor")&&m.append("div").text(c.data[v][c.columns[w].secondary_accessor]).classed("secondary-title",!0)):m.text(l)}}return this},this},function(){"use strict";function b(a,b){a.selectAll(".mg-missing-text").data([b.missing_text]).enter().append("text").attr("class","mg-missing-text").attr("x",b.width/2).attr("y",b.height/2).attr("dy",".50em").attr("text-anchor","middle").text(b.missing_text)}function c(b){b.scales.X=a.scaleLinear().domain([0,b.data.length]).range([s(b),u(b)]),b.scalefns.yf=function(a){return b.scales.Y(a.y)}}function d(b){b.scales.Y=a.scaleLinear().domain([-2,2]).range([b.height-b.bottom-2*b.buffer,b.top]),b.scalefns.xf=function(a){return b.scales.X(a.x)}}function e(a){for(var b=[],c=1;50>=c;c++)b.push({x:c,y:Math.random()-.03*c});a.data=b}function f(a,b){a.append("svg:rect").classed("mg-missing-background",!0).attr("x",b.buffer).attr("y",b.buffer+2*b.title_y_position).attr("width",b.width-2*b.buffer).attr("height",b.height-2*b.buffer-2*b.title_y_position).attr("rx",15).attr("ry",15)}function g(b,c){var d=a.line().x(c.scalefns.xf).y(c.scalefns.yf).curve(c.interpolate);b.append("path").attr("class","mg-main-line mg-line1-color").attr("d",d(c.data))}function h(b,c){var d=a.area().x(c.scalefns.xf).y0(c.scales.Y.range()[0]).y1(c.scalefns.yf).curve(c.interpolate);b.append("path").attr("class","mg-main-area mg-area1-color").attr("d",d(c.data))}function i(b){a.select(b.target).selectAll("svg *").remove()}function j(b){b.legend_target&&a.select(b.legend_target).html("")}function k(k){this.init=function(k){this.args=k,sb(k),tb(k);var l=a.select(k.target);Bb(l,k);var m=l.selectAll("svg");if(ub(m,k),m=vb(m,k),xb(m,k),yb(m,k),i(k),m.classed("mg-missing",!0),j(k),Z(k),k.show_missing_background){e(k),c(k),d(k);var n=x(m,"mg-missing-pane");f(n,k),g(n,k),h(n,k)}return b(m,k),this.windowListeners(),this},this.windowListeners=function(){return cc(this.args),this},this.init(k)}var l={top:40,bottom:30,right:10,left:0,buffer:8,legend_target:"",width:350,height:220,missing_text:"Data currently missing or unavailable",scalefns:{},scales:{},show_tooltips:!0,show_missing_background:!0};MG.register("missing-data",k,l)}.call(this),MG.raw_data_transformation=hc,MG.process_line=lc,MG.process_histogram=mc,MG.process_categorical_variables=nc,MG.process_point=oc,MG.add_ls=pc,MG.add_lowess=qc,MG.lowess_robust=rc,MG.lowess=sc,MG.least_squares=tc;var Qc=function(a,b,c,d){var e;return e="string"==typeof a?MG.time_format(d,a)(b[c]):"function"==typeof a?a(b):b[c]},Rc=function(b,c,d){var e;return e="string"==typeof b?a.format("s")(c[d]):"function"==typeof b?b(c):c[d]};return MG.format_rollover_number=Bc,MG.path_tween=Gc,MG.render_markup=Jc,MG.init_virtual_window=Kc,MG.error=Lc,MG});